<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Usage Guide &#8212; Interbase 1.4.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/interbasetheme.css?v=bda53a8a" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=34e37943"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compliance to Python Database API 2.0" href="python-db-api-compliance.html" />
    <link rel="prev" title="Getting Started with Interbase" href="getting-started.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="python-db-api-compliance.html" title="Compliance to Python Database API 2.0"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="getting-started.html" title="Getting Started with Interbase"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Interbase 1.4.9 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Usage Guide</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="usage-guide">
<h1>Usage Guide<a class="headerlink" href="#usage-guide" title="Permalink to this heading">¶</a></h1>
<section id="driver-structure">
<h2>Driver structure<a class="headerlink" href="#driver-structure" title="Permalink to this heading">¶</a></h2>
<p>Source code is currently divided into next submodules:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#module-interbase.ibase" title="interbase.ibase: Python ctypes interface to InterBase client library"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ibase</span></code></a> - Python <a class="reference external" href="https://docs.python.org/3/whatsnew/2.5.html#module-ctypes" title="(in Python v3.11)"><span class="xref std std-ref">ctypes</span></a> interface to InterBase client library.</p></li>
<li><p><a class="reference internal" href="reference.html#module-interbase.ibcore" title="interbase.ibcore: Implementation of InterBase driver"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ibcore</span></code></a> - Main driver source code.</p></li>
<li><p><a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">services</span></code></a> - Driver code to work with InterBase Services.</p></li>
<li><p><a class="reference internal" href="reference.html#module-interbase.schema" title="interbase.schema: Submodule for work with database metadata (schema)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">schema</span></code></a> - Driver code to work with InterBase database schema (metadata).</p></li>
<li><p><a class="reference internal" href="reference.html#module-interbase.utils" title="interbase.utils: Submodule with various classes and functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code></a> - Various classes and functions used by driver that are generally useful.</p></li>
</ul>
<p>All important data, functions, classes and constants are available directly in interbase namespace,
so there is not need to import or use <a class="reference internal" href="reference.html#module-interbase.ibcore" title="interbase.ibcore: Implementation of InterBase driver"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ibcore</span></code></a> and <a class="reference internal" href="reference.html#module-interbase.ibase" title="interbase.ibase: Python ctypes interface to InterBase client library"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ibase</span></code></a> submodules directly.
Exception is the <a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interbase.services</span></code></a> submodule that contains functions and classes for work with
InterBase Services. Because Services are optional, not so frequently used InterBase facility, all
service-related code was isolated in separate submodule rather than exposed directly through
main module namespace. Because <a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">services</span></code></a> submodule contains names also used by main
driver (<a class="reference internal" href="reference.html#interbase.services.connect" title="interbase.services.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a>, <a class="reference internal" href="reference.html#interbase.services.Connection" title="interbase.services.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>), it’s advised to use
fully qualified names when referring to them instead importing them via <cite>from interbase.services import …</cite>.</p>
</section>
<section id="databases">
<span id="index-0"></span><h2>Databases<a class="headerlink" href="#databases" title="Permalink to this heading">¶</a></h2>
<p>Access to the database is made available through <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> objects. Interbase provides two
constructors for these:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.connect" title="interbase.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> - Returns <cite>Connection</cite> to database that already exists.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.create_database" title="interbase.create_database"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_database()</span></code></a> - Returns <cite>Connection</cite> to newly created database.</p></li>
</ul>
<section id="using-connect">
<span id="index-1"></span><h3>Using <cite>connect</cite><a class="headerlink" href="#using-connect" title="Permalink to this heading">¶</a></h3>
<p>This constructor has number of keyword parameters that could be divided into several groups:</p>
<ul class="simple">
<li><p>Database specification (parameters <cite>dsn</cite>, <cite>host</cite>, <cite>database</cite> and <cite>port</cite>)</p></li>
<li><p>User specification (parameters <cite>user</cite>, <cite>password</cite> and <cite>role</cite>)</p></li>
<li><p>Connection options (parameters <cite>sql_dialect</cite>, <cite>charset</cite>, <cite>isolation_level</cite>, <cite>buffers</cite>,
<cite>force_writes</cite>, <cite>no_reserve</cite> and <cite>db_key_scope</cite>)</p></li>
</ul>
<p>To establish a connection to database, you always must specify the database, either as <cite>connection
string</cite> parameter <cite>dsn</cite>, or as required combination of parameters <cite>host</cite>, <cite>database</cite> and <cite>port</cite>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Current driver version ignores the value of <cite>port</cite> parameter. If you need to specify the port
number, you have to use <cite>dsn</cite> or <cite>host</cite> parameter instead.</p>
</div>
<p>Although specification of <cite>user</cite> and <cite>password</cite> parameters is optional (if environment variables
<cite>ISC_USER</cite> and <cite>ISC_PASSWORD</cite> are set, their values are used if these parameters are omitted),
it’s recommended practice to use them. Parameter <cite>role</cite> is needed only when you use InterBase roles.</p>
<p>Connection options are optional (see <a class="reference external" href="https://docwiki.embarcadero.com/InterBase/2020/en/Main_Page">InterBase Documentation</a> for details). However you may often
want to specify <cite>charset</cite>, as it directs automatic conversions of string data between client and
server, and automatic conversions from/to unicode performed by Interbase driver (see <a class="reference internal" href="#data-handling-and-conversions">Data handling
and conversions</a> for details).</p>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Connecting via &#39;dsn&#39;</span>
<span class="c1">#</span>
<span class="c1"># Local database (local protocol, if supported)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;/path/database.interbase&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Local database (TCP/IP)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:/path/database.interbase&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Local database (TCP/IP with port specification)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost/3050:/path/database.interbase&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Remote database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;host:/path/database.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Remote database with port specification</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;host/3050:/path/database.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># Connecting via &#39;database&#39;, &#39;host&#39; and &#39;port&#39;</span>
<span class="c1">#</span>
<span class="c1"># Local database (local protocol, if supported)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">&#39;/path/database.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Local database (TCP/IP)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;/path/database.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Local database (TCP/IP with port specification)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost/3050&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;/path/database.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Remote database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;myhost&#39;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">&#39;/path/database.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Interbase supports additional <cite>Connection</cite> class(es) that extend <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> functionality
in optional (opt-in) way. For example <a class="reference internal" href="reference.html#interbase.ConnectionWithSchema" title="interbase.ConnectionWithSchema"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionWithSchema</span></code></a> extends Connection interface with methods
and attributes provided by <a class="reference internal" href="reference.html#interbase.schema.Schema" title="interbase.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a>. New <cite>connection_class</cite> parameter was introduced to
<cite>connect</cite> and <cite>create_database</cite> to connect to/create database using different class than descends from
<cite>Connection</cite>.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Connecting through ConnectionWithSchema</span>
<span class="c1">#</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;/path/database.interbase&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">,</span>
                  <span class="n">connection_class</span><span class="o">=</span><span class="n">interbase</span><span class="o">.</span><span class="n">ConnectionWithSchema</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-create-database">
<span id="index-2"></span><h3>Using <cite>create_database</cite><a class="headerlink" href="#using-create-database" title="Permalink to this heading">¶</a></h3>
<p>The InterBase engine supports dynamic database creation via the SQL statement <cite>CREATE DATABASE</cite>.
Interbase wraps it into <a class="reference internal" href="reference.html#interbase.create_database" title="interbase.create_database"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_database()</span></code></a>, that returns <cite>Connection</cite> instance attached to newly
created database.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="s2">&quot;create database &#39;host:/temp/db.db&#39; user &#39;sysdba&#39; password &#39;pass&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instead <cite>CREATE DATABASE</cite> SQL statement you can use number of optional keyword parameters
introduced to <a class="reference internal" href="reference.html#interbase.create_database" title="interbase.create_database"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_database()</span></code></a>.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;/temp/db.interbase&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">,</span><span class="n">page_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="deleting-databases">
<span id="index-3"></span><h3>Deleting databases<a class="headerlink" href="#deleting-databases" title="Permalink to this heading">¶</a></h3>
<p>The InterBase engine also supports dropping (deleting) databases dynamically, but dropping is a more
complicated operation than creating, for several reasons: an existing database may be in use by users
other than the one who requests the deletion, it may have supporting objects such as temporary sort
files, and it may even have dependent shadow databases. Although the database engine recognizes a
<cite>DROP DATABASE</cite> SQL statement, support for that statement is limited to the <cite>isql</cite> command-line
administration utility. However, the engine supports the deletion of databases via an API call, which
Interbase exposes as <a class="reference internal" href="reference.html#interbase.Connection.drop_database" title="interbase.Connection.drop_database"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_database()</span></code></a> method in <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> class. So, to drop
a database you need to connect to it first.</p>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="s2">&quot;create database &#39;/temp/db.db&#39; user &#39;sysdba&#39; password &#39;pass&#39;&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;/path/database.interbase&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="connection-object">
<span id="index-4"></span><h3>Connection object<a class="headerlink" href="#connection-object" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object represents a direct link to database, and works as gateway for next operations
with it:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#executing-sql-statements">Executing SQL Statements</a>: methods <a class="reference internal" href="reference.html#interbase.Connection.execute_immediate" title="interbase.Connection.execute_immediate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_immediate()</span></code></a> and <a class="reference internal" href="reference.html#interbase.Connection.cursor" title="interbase.Connection.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cursor()</span></code></a>.</p></li>
<li><p>Dropping database: method <a class="reference internal" href="reference.html#interbase.Connection.drop_database" title="interbase.Connection.drop_database"><code class="xref py py-meth docutils literal notranslate"><span class="pre">drop_database()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#transanction-management">Transanction management</a>: methods <a class="reference internal" href="reference.html#interbase.Connection.begin" title="interbase.Connection.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">begin()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Connection.commit" title="interbase.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a>,
<a class="reference internal" href="reference.html#interbase.Connection.rollback" title="interbase.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">savepoint()</span></code>, <a class="reference internal" href="reference.html#interbase.Connection.trans" title="interbase.Connection.trans"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trans()</span></code></a>,
<a class="reference internal" href="reference.html#interbase.Connection.trans_info" title="interbase.Connection.trans_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trans_info()</span></code></a> and <a class="reference internal" href="reference.html#interbase.Connection.transaction_info" title="interbase.Connection.transaction_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transaction_info()</span></code></a>, and attributes
<a class="reference internal" href="reference.html#interbase.Connection.main_transaction" title="interbase.Connection.main_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">main_transaction</span></code></a>, <a class="reference internal" href="reference.html#interbase.Connection.transactions" title="interbase.Connection.transactions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">transactions</span></code></a>, <a class="reference internal" href="reference.html#interbase.Connection.default_tpb" title="interbase.Connection.default_tpb"><code class="xref py py-attr docutils literal notranslate"><span class="pre">default_tpb</span></code></a>
and <a class="reference internal" href="reference.html#interbase.Connection.group" title="interbase.Connection.group"><code class="xref py py-attr docutils literal notranslate"><span class="pre">group</span></code></a>.</p></li>
<li><p>Work with <a class="reference internal" href="#database-events">Database Events</a>: method <a class="reference internal" href="reference.html#interbase.Connection.event_conduit" title="interbase.Connection.event_conduit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">event_conduit()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#getting-information-about-database">Getting information about database</a>: methods <a class="reference internal" href="reference.html#interbase.Connection.db_info" title="interbase.Connection.db_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">db_info()</span></code></a> and
<a class="reference internal" href="reference.html#interbase.Connection.database_info" title="interbase.Connection.database_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">database_info()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#working-with-schema"><span class="std std-ref">Getting information about database metadata</span></a>: attribute <a class="reference internal" href="reference.html#interbase.Connection.schema" title="interbase.Connection.schema"><code class="xref py py-attr docutils literal notranslate"><span class="pre">schema</span></code></a> and <a class="reference internal" href="reference.html#interbase.Connection.ods" title="interbase.Connection.ods"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ods</span></code></a>.</p></li>
</ul>
</section>
<section id="getting-information-about-interbase-version">
<span id="index-5"></span><h3>Getting information about InterBase version<a class="headerlink" href="#getting-information-about-interbase-version" title="Permalink to this heading">¶</a></h3>
<p>Interbase provides version strings as <cite>Connection</cite> properties:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.Connection.server_version" title="interbase.Connection.server_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">server_version</span></code></a> - Legacy InterBase-friendly version string.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.Connection.version" title="interbase.Connection.version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">version</span></code></a> - Only InterBase version number. It’s a string with format:
major.minor.subrelease.build</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.Connection.engine_version" title="interbase.Connection.engine_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">engine_version</span></code></a> - Engine (major.minor) version as (float) number.</p></li>
</ul>
</section>
<section id="database-on-disk-structure">
<h3>Database On-Disk Structure<a class="headerlink" href="#database-on-disk-structure" title="Permalink to this heading">¶</a></h3>
<p>Particular InterBase features may also depend on specific support in database.
These required structures are present automatically when database is created by particular
engine version that needs them, but InterBase engine may typically work with
databases created by older versions and thus with older structure, so it could be necessary to consult
also On-Disk Structure (ODS for short) version. Interbase provides this number as <a class="reference internal" href="reference.html#interbase.Connection.ods" title="interbase.Connection.ods"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.ods</span></code></a> (float)
property.</p>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;/path/database.interbase&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;InterBase version:&#39;</span><span class="p">,</span><span class="n">con</span><span class="o">.</span><span class="n">version</span>
<span class="nb">print</span> <span class="s1">&#39;ODS version:&#39;</span><span class="p">,</span><span class="n">con</span><span class="o">.</span><span class="n">ods</span>
</pre></div>
</div>
</section>
<section id="getting-information-about-database">
<span id="index-6"></span><h3>Getting information about database<a class="headerlink" href="#getting-information-about-database" title="Permalink to this heading">¶</a></h3>
<p>InterBase provides various information about server and connected database via <cite>database_info</cite> API call.
Interbase surfaces this API through methods <a class="reference internal" href="reference.html#interbase.Connection.db_info" title="interbase.Connection.db_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">db_info()</span></code></a> and <a class="reference internal" href="reference.html#interbase.Connection.database_info" title="interbase.Connection.database_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">database_info()</span></code></a>
on Connection object.</p>
<p><a class="reference internal" href="reference.html#interbase.Connection.database_info" title="interbase.Connection.database_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.database_info()</span></code></a> is a <cite>very thin</cite> wrapper around function <cite>isc_database_info()</cite>.
This method does not attempt to interpret its results except with regard to whether they are a string
or an integer. For example, requesting <cite>isc_info_user_names</cite> with the call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">database_info</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_user_names</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will return a binary string containing a raw succession of length-name pairs.</p>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:/temp/test.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>

<span class="c1"># Retrieving an integer info item is quite simple.</span>
<span class="n">bytesInUse</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">database_info</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_current_memory</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="s1">&#39;The server is currently using </span><span class="si">%d</span><span class="s1"> bytes of memory.&#39;</span> <span class="o">%</span> <span class="n">bytesInUse</span>

<span class="c1"># Retrieving a string info item is somewhat more involved, because the</span>
<span class="c1"># information is returned in a raw binary buffer that must be parsed</span>
<span class="c1"># according to the rules defined in the InterBase® 6 API Guide section</span>
<span class="c1"># entitled &quot;Requesting buffer items and result buffer values&quot; (page 51).</span>
<span class="c1">#</span>
<span class="c1"># Often, the buffer contains a succession of length-string pairs</span>
<span class="c1"># (one byte telling the length of s, followed by s itself).</span>
<span class="c1"># Function interbase.ibase.ord2 is provided to convert a raw</span>
<span class="c1"># byte to a Python integer (see examples below).</span>
<span class="n">buf</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">database_info</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_db_id</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="c1"># Parse the filename from the buffer.</span>
<span class="n">beginningOfFilename</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># The second byte in the buffer contains the size of the database filename</span>
<span class="c1"># in bytes.</span>
<span class="n">lengthOfFilename</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">ibase</span><span class="o">.</span><span class="n">ord2</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">beginningOfFilename</span><span class="p">:</span><span class="n">beginningOfFilename</span> <span class="o">+</span> <span class="n">lengthOfFilename</span><span class="p">]</span>

<span class="c1"># Parse the host name from the buffer.</span>
<span class="n">beginningOfHostName</span> <span class="o">=</span> <span class="p">(</span><span class="n">beginningOfFilename</span> <span class="o">+</span> <span class="n">lengthOfFilename</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1"># The first byte after the end of the database filename contains the size</span>
<span class="c1"># of the host name in bytes.</span>
<span class="n">lengthOfHostName</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">ibase</span><span class="o">.</span><span class="n">ord2</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">beginningOfHostName</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">beginningOfHostName</span><span class="p">:</span><span class="n">beginningOfHostName</span> <span class="o">+</span> <span class="n">lengthOfHostName</span><span class="p">]</span>

<span class="nb">print</span> <span class="s1">&#39;We are connected to the database at </span><span class="si">%s</span><span class="s1"> on host </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">host</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">server</span> <span class="ow">is</span> <span class="n">currently</span> <span class="n">using</span> <span class="mi">8931328</span> <span class="nb">bytes</span> <span class="n">of</span> <span class="n">memory</span><span class="o">.</span>
<span class="n">We</span> <span class="n">are</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">the</span> <span class="n">database</span> <span class="n">at</span> <span class="n">C</span><span class="p">:</span>\<span class="n">TEMP</span>\<span class="n">TEST</span><span class="o">.</span><span class="n">DB</span> <span class="n">on</span> <span class="n">host</span> <span class="n">WEASEL</span><span class="o">.</span>
</pre></div>
</div>
<p>A more convenient way to access the same functionality is via the <a class="reference internal" href="reference.html#interbase.Connection.db_info" title="interbase.Connection.db_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">db_info()</span></code></a> method,
which is high-level convenience wrapper around the <cite>database_info()</cite> method that parses the output of
database_info into Python-friendly objects instead of returning raw binary buffers in the case of complex
result types. For example, requesting <cite>isc_info_user_names</cite> with the call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">con</span><span class="o">.</span><span class="n">db_info</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_user_names</span><span class="p">)</span>
</pre></div>
</div>
<p>returns a dictionary that maps (username -&gt; number of open connections). If SYSDBA has one open connection
to the database to which <cite>con</cite> is connected, and TEST_USER_1 has three open connections to that same database,
the return value would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{‘SYSDBA’: 1, ‘TEST_USER_1’: 3}
</pre></div>
</div>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Querying an isc_info_* item that has a complex result:</span>
<span class="c1">###############################################################################</span>
<span class="c1"># Establish three connections to the test database as TEST_USER_1, and one</span>
<span class="c1"># connection as SYSDBA.  Then use the Connection.db_info method to query the</span>
<span class="c1"># number of attachments by each user to the test database.</span>
<span class="n">testUserCons</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
  <span class="n">tcon</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:/temp/test.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;TEST_USER_1&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
  <span class="n">testUserCons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tcon</span><span class="p">)</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:/temp/test.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="s1">&#39;Open connections to this database:&#39;</span>
<span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">db_info</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_user_names</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Querying multiple isc_info_* items at once:</span>
<span class="c1">###############################################################################</span>
<span class="c1"># Request multiple db_info items at once, specifically the page size of the</span>
<span class="c1"># database and the number of pages currently allocated.  Compare the size</span>
<span class="c1"># computed by that method with the size reported by the file system.</span>
<span class="c1"># The advantages of using db_info instead of the file system to compute</span>
<span class="c1"># database size are:</span>
<span class="c1">#   - db_info works seamlessly on connections to remote databases that reside</span>
<span class="c1">#     in file systems to which the client program lacks access.</span>
<span class="c1">#   - If the database is split across multiple files, db_info includes all of</span>
<span class="c1">#     them.</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">db_info</span><span class="p">([</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_page_size</span><span class="p">,</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_allocation</span><span class="p">])</span>
<span class="n">pagesAllocated</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_allocation</span><span class="p">]</span>
<span class="n">pageSize</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_page_size</span><span class="p">]</span>
<span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">db_info indicates database size is&#39;</span><span class="p">,</span> <span class="n">pageSize</span> <span class="o">*</span> <span class="n">pagesAllocated</span><span class="p">,</span> <span class="s1">&#39;bytes&#39;</span>
<span class="nb">print</span> <span class="s1">&#39;os.path.getsize indicates size is &#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">DB_FILENAME</span><span class="p">),</span> <span class="s1">&#39;bytes&#39;</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Open</span> <span class="n">connections</span> <span class="n">to</span> <span class="n">this</span> <span class="n">database</span><span class="p">:</span>
<span class="p">{</span><span class="s1">&#39;SYSDBA&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;TEST_USER_1&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="n">db_info</span> <span class="n">indicates</span> <span class="n">database</span> <span class="n">size</span> <span class="ow">is</span> <span class="mi">20684800</span> <span class="nb">bytes</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span> <span class="n">indicates</span> <span class="n">size</span> <span class="ow">is</span>  <span class="mi">20684800</span> <span class="nb">bytes</span>
</pre></div>
</div>
</section>
</section>
<section id="executing-sql-statements">
<span id="index-7"></span><h2>Executing SQL Statements<a class="headerlink" href="#executing-sql-statements" title="Permalink to this heading">¶</a></h2>
<p>Interbase implements two ways for execution of SQL commands against connected database:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.Connection.execute_immediate" title="interbase.Connection.execute_immediate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_immediate()</span></code></a> - for execution of SQL commands that don’t
return any result.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor" title="interbase.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> objects that offer rich interface for execution of SQL commands and
fetching their results.</p></li>
</ul>
<section id="cursor-object">
<span id="index-8"></span><h3>Cursor object<a class="headerlink" href="#cursor-object" title="Permalink to this heading">¶</a></h3>
<p>Because <cite>Cursor</cite> objects always operate in context of single <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> (and <a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a>),
<cite>Cursor</cite> instances are not created directly, but by constructor method. Python DB API 2.0 assume that
if database engine supports transactions, it supports only one transaction per connection, hence it
defines constructor method <a class="reference internal" href="reference.html#interbase.Connection.cursor" title="interbase.Connection.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cursor()</span></code></a> (and other transaction-related methods) as part
of <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> interface. However, InterBase supports multiple independent transactions per
connection. To conform to Python DB API, Interbase uses concept of internal <a class="reference internal" href="reference.html#interbase.Connection.main_transaction" title="interbase.Connection.main_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">main_transaction</span></code></a>
and secondary <a class="reference internal" href="reference.html#interbase.Connection.transactions" title="interbase.Connection.transactions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">transactions</span></code></a>. Cursor constructor is primarily defined by
<a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a>, and Cursor constructor on <cite>Connection</cite> is therefore a shortcut for <cite>main_transaction.cursor()</cite>.</p>
<p><cite>Cursor</cite> objects are used for next operations:</p>
<ul class="simple">
<li><p>Execution of SQL Statements: methods <a class="reference internal" href="reference.html#interbase.Cursor.execute" title="interbase.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Cursor.executemany" title="interbase.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a> and
<a class="reference internal" href="reference.html#interbase.Cursor.callproc" title="interbase.Cursor.callproc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">callproc()</span></code></a>.</p></li>
<li><p>Creating <a class="reference internal" href="reference.html#interbase.PreparedStatement" title="interbase.PreparedStatement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PreparedStatement</span></code></a> objects for efficient repeated execution of SQL statements, and
to obtain additional information about SQL statements (like execution <a class="reference internal" href="reference.html#interbase.PreparedStatement.plan" title="interbase.PreparedStatement.plan"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plan</span></code></a>):
method <a class="reference internal" href="reference.html#interbase.Cursor.prep" title="interbase.Cursor.prep"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prep()</span></code></a>.</p></li>
<li><p><a class="reference external" href="Fetchingdatafromserver">Fetching results</a>: methods <a class="reference internal" href="reference.html#interbase.Cursor.fetchone" title="interbase.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Cursor.fetchmany" title="interbase.Cursor.fetchmany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchmany()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Cursor.fetchall" title="interbase.Cursor.fetchall"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchall()</span></code></a>,
<a class="reference internal" href="reference.html#interbase.Cursor.fetchonemap" title="interbase.Cursor.fetchonemap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchonemap()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Cursor.fetchmanymap" title="interbase.Cursor.fetchmanymap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchmanymap()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Cursor.fetchallmap" title="interbase.Cursor.fetchallmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchallmap()</span></code></a>,
<a class="reference internal" href="reference.html#interbase.Cursor.iter" title="interbase.Cursor.iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iter()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Cursor.itermap" title="interbase.Cursor.itermap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">itermap()</span></code></a> and <a class="reference internal" href="reference.html#interbase.Cursor.next" title="interbase.Cursor.next"><code class="xref py py-meth docutils literal notranslate"><span class="pre">next()</span></code></a>.</p></li>
</ul>
</section>
<section id="sql-execution-basics">
<span id="index-9"></span><h3>SQL Execution Basics<a class="headerlink" href="#sql-execution-basics" title="Permalink to this heading">¶</a></h3>
<p>There are three methods how to execute SQL commands:</p>
<ul>
<li><p><a class="reference internal" href="reference.html#interbase.Connection.execute_immediate" title="interbase.Connection.execute_immediate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execute_immediate()</span></code></a> or <a class="reference internal" href="reference.html#interbase.Transaction.execute_immediate" title="interbase.Transaction.execute_immediate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Transaction.execute_immediate()</span></code></a> for SQL commands that
don’t return any result, and are not executed frequently. This method also <strong>doesn’t</strong> support either
<a class="reference internal" href="#id1">parameterized statements</a> or <a class="reference internal" href="#id2">prepared statements</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method is efficient for <cite>administrative</cite> and <a class="reference external" href="http://en.wikipedia.org/wiki/Data_Definition_Language">DDL</a> SQL commands, like <cite>DROP</cite>, <cite>CREATE</cite> or <cite>ALTER</cite>
commands, <cite>SET STATISTICS</cite> etc.</p>
</div>
</li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.execute" title="interbase.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.execute()</span></code></a> or <a class="reference internal" href="reference.html#interbase.Cursor.executemany" title="interbase.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.executemany()</span></code></a> for commands that return result sets, i.e. sequence
of <cite>rows</cite> of the same structure, and sequence has unknown number of <cite>rows</cite> (including zero).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method is preferred for all <cite>SELECT</cite> and other <a class="reference external" href="http://en.wikipedia.org/wiki/Data_Manipulation_Language">DML</a> statements, or any statement that is executed
frequently, either <cite>as is</cite> or in <cite>parameterized</cite> form.</p>
</div>
</li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.callproc" title="interbase.Cursor.callproc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.callproc()</span></code></a> for execution of <cite>Stored procedures</cite> that always return exactly one set of values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method of SP invocation is equivalent to <cite>“EXECUTE PROCEDURE …”</cite> SQL statement.</p>
</div>
</li>
</ul>
</section>
<section id="parameterized-statements">
<span id="index-10"></span><span id="id1"></span><h3>Parameterized statements<a class="headerlink" href="#parameterized-statements" title="Permalink to this heading">¶</a></h3>
<p>When SQL command you want to execute contains data <cite>values</cite>, you can either:</p>
<ul>
<li><p>Embed them <cite>directly</cite> or via <cite>string formatting</cite> into command <cite>string</cite>, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into the_table (a,b,c) values (&#39;aardvark&#39;, 1, 0.1)&quot;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from the_table where col == &#39;aardvark&#39;&quot;</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into the_table (a,b,c) values (&#39;</span><span class="si">%s</span><span class="s2">&#39;, </span><span class="si">%i</span><span class="s2">, </span><span class="si">%f</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;aardvark&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from the_table where col == &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="s1">&#39;aardvark&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Use parameter marker (<cite>?</cite>) in command <cite>string</cite> in the slots where values are expected, then supply
those values as Python list or tuple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into the_table (a,b,c) values (?,?,?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;aardvark&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from the_table where col == ?&quot;</span><span class="p">,(</span><span class="s1">&#39;aardvark&#39;</span><span class="p">,))</span>
</pre></div>
</div>
</li>
</ul>
<p>While both methods have the same results, the second one (called <cite>parameterized</cite>) has several important
advantages:</p>
<ul class="simple">
<li><p>You don’t need to handle conversions from Python data types to strings.</p></li>
<li><p>Interbase will handle all data type conversions (if necessary) from Python data types to InterBase ones,
including <cite>None/NULL</cite> conversion and conversion from <cite>unicode</cite> to <cite>byte strings</cite> in encoding expected
by server.</p></li>
<li><p>You may pass BLOB values as open <cite>file-like</cite> objects, and Interbase will handle the transfer of BLOB value.</p></li>
<li><p>If you’ll pass exactly the same command <cite>string</cite> again to particular <a class="reference internal" href="reference.html#interbase.Cursor" title="interbase.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> instance,
it will be executed more efficiently (see section about <a class="reference internal" href="#id2">Prepared Statements</a> for details).</p></li>
</ul>
<p>Parameterized statements also have some limitations. Currently:</p>
<ul class="simple">
<li><p><cite>DATE</cite>, <cite>TIME</cite> and <cite>DATETIME</cite> values must be relevant <a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a> objects.</p></li>
<li><p><cite>NUMERIC</cite> and <cite>DECIMAL</cite> values must be <a class="reference external" href="https://docs.python.org/3/library/decimal.html#module-decimal" title="(in Python v3.11)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">decimal</span></code></a> objects.</p></li>
</ul>
</section>
<section id="fetching-data-from-server">
<span id="index-11"></span><h3>Fetching data from server<a class="headerlink" href="#fetching-data-from-server" title="Permalink to this heading">¶</a></h3>
<p>Result of SQL statement execution consists from sequence of zero to unknown number of <cite>rows</cite>, where each
<cite>row</cite> is a set of exactly the same number of values. <a class="reference internal" href="reference.html#interbase.Cursor" title="interbase.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> object offer number of different
methods for fetching these <cite>rows</cite>, that should satisfy all your specific needs:</p>
<ul>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.fetchone" title="interbase.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code></a> - Returns the next row of a query result set, or <cite>None</cite> when no more data is
available.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Cursor supports the <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a>, yielding tuples of values like
<a class="reference internal" href="reference.html#interbase.Cursor.fetchone" title="interbase.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code></a>.</p>
</div>
</li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.fetchmany" title="interbase.Cursor.fetchmany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchmany()</span></code></a> - Returns the next set of rows of a query result, returning a sequence of
sequences (e.g. a list of tuples). An empty sequence is returned when no more rows are available.</p>
<p>The number of rows to fetch per call is specified by the parameter. If it is not given, the cursor’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">arraysize</span></code> determines the number of rows to be fetched. The method does try to fetch
as many rows as indicated by the size parameter. If this is not possible due to the specified number
of rows not being available, fewer rows may be returned.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value of <code class="xref py py-attr docutils literal notranslate"><span class="pre">arraysize</span></code> is <cite>1</cite>, so without parameter it’s equivalent to
<a class="reference internal" href="reference.html#interbase.Cursor.fetchone" title="interbase.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code></a>, but returns list of <cite>rows</cite>, instead actual <cite>row</cite> directly.</p>
</div>
</li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.fetchall" title="interbase.Cursor.fetchall"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchall()</span></code></a> -  Returns all (remaining) rows of a query result as list of tuples, where
each tuple is one row of returned values.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method can potentially return huge amount of data, that may exhaust available memory.
If you need just <cite>iteration</cite> over potentially big result set, use loops with <a class="reference internal" href="reference.html#interbase.Cursor.fetchone" title="interbase.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code></a>,
Cursor’s built-in support for <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a> or call to <a class="reference internal" href="reference.html#interbase.Cursor.iter" title="interbase.Cursor.iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iter()</span></code></a>
instead this method.</p>
</div>
</li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.fetchonemap" title="interbase.Cursor.fetchonemap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchonemap()</span></code></a> - Returns the next row like <a class="reference internal" href="reference.html#interbase.Cursor.fetchone" title="interbase.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code></a>, but returns a mapping
of <cite>field name</cite> to <cite>field value</cite>, rather than a tuple.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.fetchmanymap" title="interbase.Cursor.fetchmanymap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchmanymap()</span></code></a> - Returns the next set of rows of a query result like <a class="reference internal" href="reference.html#interbase.Cursor.fetchmany" title="interbase.Cursor.fetchmany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchmany()</span></code></a>,
but returns a list of mapping of <cite>field name</cite> to <cite>field value</cite>, rather than a tuple.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.fetchallmap" title="interbase.Cursor.fetchallmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchallmap()</span></code></a> - Returns all (remaining) rows of a query result like <a class="reference internal" href="reference.html#interbase.Cursor.fetchall" title="interbase.Cursor.fetchall"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchall()</span></code></a>,
returns a list of mappings of <cite>field name</cite> to <cite>field value</cite>, rather than a tuple.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method can potentially return huge amount of data, that may exhaust available memory.
If you need just <cite>iteration</cite> over potentially big result set with mapping support, use
<a class="reference internal" href="reference.html#interbase.Cursor.itermap" title="interbase.Cursor.itermap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">itermap()</span></code></a> instead this method.</p>
</div>
</li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.iter" title="interbase.Cursor.iter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iter()</span></code></a> - Equivalent to the <a class="reference internal" href="reference.html#interbase.Cursor.fetchall" title="interbase.Cursor.fetchall"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchall()</span></code></a>, except that it returns <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator</span></a> rather than materialized list.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.Cursor.itermap" title="interbase.Cursor.itermap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">itermap()</span></code></a> - Equivalent to the <a class="reference internal" href="reference.html#interbase.Cursor.fetchallmap" title="interbase.Cursor.fetchallmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchallmap()</span></code></a>, except that it returns
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator</span></a> rather than materialized list.</p></li>
<li><p>Call to <a class="reference internal" href="reference.html#interbase.Cursor.execute" title="interbase.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> returns self (Cursor instance) that itself supports
the <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a>, yielding tuples of values like <a class="reference internal" href="reference.html#interbase.Cursor.fetchone" title="interbase.Cursor.fetchone"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetchone()</span></code></a>.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Interbase makes absolutely no guarantees about the return value of the <cite>fetchone</cite> / <cite>fetchmany</cite> / <cite>fetchall</cite>
methods except that it is a sequence indexed by field position. Interbase makes absolutely no guarantees about
the return value of the <cite>fetchonemap</cite> / <cite>fetchmanymap</cite> / <cite>fetchallmap</cite> methods except that it is a mapping
of field name to field value. Therefore, client programmers should not rely on the return value being
an instance of a particular class or type.</p>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;/temp/test.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">SELECT</span> <span class="o">=</span> <span class="s2">&quot;select name, year_released from languages order by year_released&quot;</span>

<span class="c1"># 1. Using built-in support for iteration protocol to iterate over the rows available from the cursor,</span>
<span class="c1"># unpacking the resulting sequences to yield their elements (name, year_released):</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SELECT</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year_released</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> has been publicly available since </span><span class="si">%d</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year_released</span><span class="p">)</span>
<span class="c1"># or alternatively you can take an advantage of cur.execute returning self.</span>
<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year_released</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SELECT</span><span class="p">):</span>
    <span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> has been publicly available since </span><span class="si">%d</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">year_released</span><span class="p">)</span>

<span class="c1"># 2. Equivalently using fetchall():</span>
<span class="c1"># This is potentially dangerous if result set is huge, as the whole result set is first materialized</span>
<span class="c1"># as list and then used for iteration.</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SELECT</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
    <span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> has been publicly available since </span><span class="si">%d</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># 3. Using mapping-iteration rather than sequence-iteration:</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SELECT</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">itermap</span><span class="p">():</span>
    <span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%(name)s</span><span class="s1"> has been publicly available since </span><span class="si">%(year_released)d</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">row</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="reference internal" href="reference.html#interbase.Cursor.execute" title="interbase.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.execute()</span></code></a> and <a class="reference internal" href="reference.html#interbase.Cursor.executemany" title="interbase.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.executemany()</span></code></a> return self, so you can use calls to them
as iterators (see example above).</p>
</div>
</section>
<section id="prepared-statements">
<span id="index-12"></span><span id="id2"></span><h3>Prepared Statements<a class="headerlink" href="#prepared-statements" title="Permalink to this heading">¶</a></h3>
<p>Execution of any SQL statement has three phases:</p>
<ul class="simple">
<li><p><em>Preparation</em>: command is analyzed, validated, execution plan is determined by optimizer and all
necessary data structures (for example for input and output parameters) are initialized.</p></li>
<li><p><em>Execution</em>: input parameters (if any) are passed to server and previously prepared statement is
actually executed by database engine.</p></li>
<li><p><em>Fetching</em>: result of execution and data (if any) are transferred from server to client, and
allocated resources are then released.</p></li>
</ul>
<p>The preparation phase consumes some amount of server resources (memory and CPU). Although preparation
and release of resources typically takes only small amount of CPU time, it builds up as number
of executed statements grows. InterBase (like most database engines) allows to spare this time for
subsequent execution if particular statement should be executed repeatedly - by reusing once prepared
statement for repeated execution. This may save significant amount of server processing time, and result
in better overall performance.</p>
<p>Interbase builds on this by encapsulating all statement-related code into separate <a class="reference internal" href="reference.html#interbase.PreparedStatement" title="interbase.PreparedStatement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PreparedStatement</span></code></a>
class, and implementing <a class="reference internal" href="reference.html#interbase.Cursor" title="interbase.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> class as a wrapper around it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Interbase’s implementation of Cursor somewhat violates the Python DB API 2.0, which requires that cursor
will be unusable after call to <cite>close</cite>; and an Error (or subclass) exception should be raised if
any operation is attempted with the cursor.</p>
<p>If you’ll take advantage of this <cite>anomaly</cite>, your code would be less portable to other Python DB
API 2.0 compliant drivers.</p>
</div>
<p>Beside SQL command string, <cite>Cursor</cite> also allows to acquire and use <cite>PreparedStatement</cite> instances explicitly.
<cite>PreparedStatement</cite> are acquired by calling <a class="reference internal" href="reference.html#interbase.Cursor.prep" title="interbase.Cursor.prep"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prep()</span></code></a> method could be then passed to <a class="reference internal" href="reference.html#interbase.Cursor.execute" title="interbase.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a>
or <a class="reference internal" href="reference.html#interbase.Cursor.executemany" title="interbase.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a> instead <cite>command string</cite>.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insertStatement</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="s2">&quot;insert into the_table (a,b,c) values (?,?,?)&quot;</span><span class="p">)</span>

<span class="n">inputRows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;aardvark&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;zymurgy&#39;</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">,</span> <span class="mf">99999.999</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mf">9.9</span><span class="p">)</span>
  <span class="p">]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">inputRows</span><span class="p">:</span>
   <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insertStatement</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># or you can use executemany</span>
<span class="c1">#</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="n">insertStatement</span><span class="p">,</span> <span class="n">inputRows</span><span class="p">)</span>
</pre></div>
</div>
<p>Prepared statements are bound to <cite>Cursor</cite> instance that created them, and can’t be used with any other
<cite>Cursor</cite> instance. Beside repeated execution they are also useful to get information about statement (like
its output <a class="reference internal" href="reference.html#interbase.PreparedStatement.description" title="interbase.PreparedStatement.description"><code class="xref py py-attr docutils literal notranslate"><span class="pre">description</span></code></a>, execution <a class="reference internal" href="reference.html#interbase.PreparedStatement.plan" title="interbase.PreparedStatement.plan"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plan</span></code></a> or
<a class="reference internal" href="reference.html#interbase.PreparedStatement.statement_type" title="interbase.PreparedStatement.statement_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">statement_type</span></code></a>) before its execution.</p>
<p><strong>Example Program:</strong></p>
<p>The following program demonstrates the explicit use of <cite>PreparedStatements</cite>. It also benchmarks explicit
<cite>PreparedStatement</cite> reuse against normal execution that prepares statements on each execution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span>
  <span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create supporting database entities:</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;recreate table t (a int, b varchar(50))&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;create unique index unique_t_a on t(a)&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Explicitly prepare the insert statement:</span>
<span class="n">psIns</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="s2">&quot;insert into t (a,b) values (?,?)&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;psIns.sql: &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">psIns</span><span class="o">.</span><span class="n">sql</span>
<span class="nb">print</span> <span class="s1">&#39;psIns.statement_type == interbase.isc_info_sql_stmt_insert:&#39;</span><span class="p">,</span> <span class="p">(</span>
    <span class="n">psIns</span><span class="o">.</span><span class="n">statement_type</span> <span class="o">==</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_sql_stmt_insert</span>
  <span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;psIns.n_input_params: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">psIns</span><span class="o">.</span><span class="n">n_input_params</span>
<span class="nb">print</span> <span class="s1">&#39;psIns.n_output_params: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">psIns</span><span class="o">.</span><span class="n">n_output_params</span>
<span class="nb">print</span> <span class="s1">&#39;psIns.plan: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">psIns</span><span class="o">.</span><span class="n">plan</span>

<span class="nb">print</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">iStart</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># The client programmer uses a PreparedStatement explicitly:</span>
<span class="n">startTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">iStart</span><span class="p">,</span> <span class="n">iStart</span> <span class="o">+</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psIns</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
<span class="nb">print</span> <span class="p">(</span>
    <span class="s1">&#39;With explicit prepared statement, performed&#39;</span>
    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  </span><span class="si">%0.2f</span><span class="s1"> insertions per second.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">startTime</span><span class="p">))</span>
  <span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="n">iStart</span> <span class="o">+=</span> <span class="n">N</span>

<span class="c1"># A new SQL string containing the inputs is submitted every time.  Also, in a</span>
<span class="c1"># more complicated scenario where the end user supplied the string input</span>
<span class="c1"># values, the program would risk SQL injection attacks:</span>
<span class="n">startTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">iStart</span><span class="p">,</span> <span class="n">iStart</span> <span class="o">+</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into t (a,b) values (</span><span class="si">%d</span><span class="s2">,&#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
<span class="nb">print</span> <span class="p">(</span>
    <span class="s1">&#39;When unable to reuse prepared statement, performed&#39;</span>
    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  </span><span class="si">%0.2f</span><span class="s1"> insertions per second.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">startTime</span><span class="p">))</span>
  <span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Prepare a SELECT statement and examine its properties.  The optimizer&#39;s plan</span>
<span class="c1"># should use the unique index that we created at the beginning of this program.</span>
<span class="nb">print</span>
<span class="n">psSel</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="s2">&quot;select * from t where a = ?&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;psSel.sql: &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">psSel</span><span class="o">.</span><span class="n">sql</span>
<span class="nb">print</span> <span class="s1">&#39;psSel.statement_type == interbase.isc_info_sql_stmt_select:&#39;</span><span class="p">,</span> <span class="p">(</span>
    <span class="n">psSel</span><span class="o">.</span><span class="n">statement_type</span> <span class="o">==</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_sql_stmt_select</span>
  <span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;psSel.n_input_params: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">psSel</span><span class="o">.</span><span class="n">n_input_params</span>
<span class="nb">print</span> <span class="s1">&#39;psSel.n_output_params: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">psSel</span><span class="o">.</span><span class="n">n_output_params</span>
<span class="nb">print</span> <span class="s1">&#39;psSel.plan: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">psSel</span><span class="o">.</span><span class="n">plan</span>

<span class="c1"># The current implementation does not allow PreparedStatements to be prepared</span>
<span class="c1"># on one Cursor and executed on another:</span>
<span class="nb">print</span>
<span class="nb">print</span> <span class="s1">&#39;Note that PreparedStatements are not transferrable from one cursor to another:&#39;</span>
<span class="n">cur2</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cur2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psSel</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psIns</span><span class="o">.</span><span class="n">sql</span><span class="p">:</span> <span class="s2">&quot;insert into t (a,b) values (?,?)&quot;</span>
<span class="n">psIns</span><span class="o">.</span><span class="n">statement_type</span> <span class="o">==</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_sql_stmt_insert</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">psIns</span><span class="o">.</span><span class="n">n_input_params</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">psIns</span><span class="o">.</span><span class="n">n_output_params</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">psIns</span><span class="o">.</span><span class="n">plan</span><span class="p">:</span> <span class="kc">None</span>

<span class="n">With</span> <span class="n">explicit</span> <span class="n">prepared</span> <span class="n">statement</span><span class="p">,</span> <span class="n">performed</span>
  <span class="mf">4276.00</span> <span class="n">insertions</span> <span class="n">per</span> <span class="n">second</span><span class="o">.</span>
<span class="n">When</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">reuse</span> <span class="n">prepared</span> <span class="n">statement</span><span class="p">,</span> <span class="n">performed</span>
  <span class="mf">2037.70</span> <span class="n">insertions</span> <span class="n">per</span> <span class="n">second</span><span class="o">.</span>

<span class="n">psSel</span><span class="o">.</span><span class="n">sql</span><span class="p">:</span> <span class="s2">&quot;select * from t where a = ?&quot;</span>
<span class="n">psSel</span><span class="o">.</span><span class="n">statement_type</span> <span class="o">==</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_sql_stmt_select</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">psSel</span><span class="o">.</span><span class="n">n_input_params</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">psSel</span><span class="o">.</span><span class="n">n_output_params</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">psSel</span><span class="o">.</span><span class="n">plan</span><span class="p">:</span> <span class="n">PLAN</span> <span class="p">(</span><span class="n">T</span> <span class="n">INDEX</span> <span class="p">(</span><span class="n">UNIQUE_T_A</span><span class="p">))</span>

<span class="n">Note</span> <span class="n">that</span> <span class="n">PreparedStatements</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">transferrable</span> <span class="kn">from</span> <span class="nn">one</span> <span class="n">cursor</span> <span class="n">to</span> <span class="n">another</span><span class="p">:</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;pstest.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">85</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">cur2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psSel</span><span class="p">)</span>
     <span class="n">File</span> <span class="s2">&quot;/home/job/python/envs/pyinterbase/interbase/interbase/ibcore.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2623</span><span class="p">,</span> <span class="ow">in</span> <span class="n">execute</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PreparedStatement was created by different Cursor.&quot;</span><span class="p">)</span>
<span class="ne">ValueError</span><span class="p">:</span> <span class="n">PreparedStatement</span> <span class="n">was</span> <span class="n">created</span> <span class="n">by</span> <span class="n">different</span> <span class="n">Cursor</span><span class="o">.</span>
</pre></div>
</div>
<p>As you can see, the version that prevents the reuse of prepared statements is about two times slower
– <em>for a trivial statement</em>. In a real application, SQL statements are likely to be far more complicated,
so the speed advantage of using prepared statements would only increase.</p>
</section>
<section id="named-cursors">
<span id="index-13"></span><h3>Named Cursors<a class="headerlink" href="#named-cursors" title="Permalink to this heading">¶</a></h3>
<p>To allow the Python programmer to perform scrolling <cite>UPDATE</cite> or <cite>DELETE</cite> via the <cite>“SELECT … FOR UPDATE”</cite>
syntax, Interbase provides the read/write property <a class="reference internal" href="reference.html#interbase.Cursor.name" title="interbase.Cursor.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Cursor.name</span></code></a>.</p>
<p><strong>Example Program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:/temp/test.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="n">curScroll</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">curUpdate</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">curScroll</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select city from addresses for update&quot;</span><span class="p">)</span>
<span class="n">curScroll</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;city_scroller&#39;</span>
<span class="n">update</span> <span class="o">=</span> <span class="s2">&quot;update addresses set city=? where current of &quot;</span> <span class="o">+</span> <span class="n">curScroll</span><span class="o">.</span><span class="n">name</span>

<span class="k">for</span> <span class="p">(</span><span class="n">city</span><span class="p">,)</span> <span class="ow">in</span> <span class="n">curScroll</span><span class="p">:</span>
    <span class="n">city</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># make some changes to city</span>
    <span class="n">curUpdate</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="n">city</span><span class="p">,)</span> <span class="p">)</span>

<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="working-with-stored-procedures">
<span id="index-14"></span><h3>Working with stored procedures<a class="headerlink" href="#working-with-stored-procedures" title="Permalink to this heading">¶</a></h3>
<p>InterBase stored procedures can have <cite>input</cite> parameters and/or <cite>output</cite> parameters. Some databases support
<cite>input/output</cite> parameters, where the same parameter is used for both input and output; InterBase does not
support this.</p>
<p>It is important to distinguish between procedures that <cite>return a result set</cite> and procedures that <cite>populate
and return their output parameters</cite> exactly once. Conceptually, the latter “return their output parameters”
like a Python function, whereas the former “yield result rows” like a Python generator.</p>
<p>InterBase’s <cite>server-side</cite> procedural SQL syntax makes no such distinction, but client-side SQL code (and C
API code) must. A result set is retrieved from a stored procedure by <cite>SELECT’ing from the procedure,
whereas output parameters are retrieved with an ‘EXECUTE PROCEDURE’ statement</cite>.</p>
<p>To <strong>retrieve a result set</strong> from a stored procedure with Interbase, use code such as this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select output1, output2 from the_proc(?, ?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">))</span>

<span class="c1"># Ordinary fetch code here, such as:</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
   <span class="o">...</span> <span class="c1"># process row</span>

<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># If the procedure had any side effects, commit them.</span>
</pre></div>
</div>
<p>To <strong>execute</strong> a stored procedure and <strong>access its output parameters</strong>, use code such as this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">callproc</span><span class="p">(</span><span class="s2">&quot;the_proc&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">))</span>

<span class="c1"># If there are output parameters, retrieve them as though they were the</span>
<span class="c1"># first row of a result set.  For example:</span>
<span class="n">outputParams</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>

<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># If the procedure had any side effects, commit them.</span>
</pre></div>
</div>
<p>This latter is not very elegant; it would be preferable to access the procedure’s output parameters as
the return value of <a class="reference internal" href="reference.html#interbase.Cursor.callproc" title="interbase.Cursor.callproc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.callproc()</span></code></a>. The Python DB API specification requires the current behavior,
however.</p>
</section>
</section>
<section id="data-handling-and-conversions">
<span id="index-15"></span><h2>Data handling and conversions<a class="headerlink" href="#data-handling-and-conversions" title="Permalink to this heading">¶</a></h2>
<section id="implicit-conversion-of-input-parameters-from-strings">
<span id="index-16"></span><h3>Implicit Conversion of Input Parameters from Strings<a class="headerlink" href="#implicit-conversion-of-input-parameters-from-strings" title="Permalink to this heading">¶</a></h3>
<p>The database engine treats most SQL data types in a weakly typed fashion: the engine may attempt to convert
the raw value to a different type, as appropriate for the current context. For instance, the SQL expressions
<cite>123</cite> (integer) and <cite>‘123’</cite> (string) are treated equivalently when the value is to be inserted into
an <cite>integer</cite> field; the same applies when <cite>‘123’</cite> and <cite>123</cite> are to be inserted into a <cite>varchar</cite> field.</p>
<p>This weak typing model is quite unlike Python’s dynamic yet strong typing. Although weak typing is regarded
with suspicion by most experienced Python programmers, the database engine is in certain situations so
aggressive about its typing model that KInterbasDB must compromise in order to remain an elegant means
of programming the database engine.</p>
<p>An example is the handling of “magic values” for date and time fields. The database engine interprets certain
string values such as <cite>‘yesterday’</cite> and <cite>‘now’</cite> as having special meaning in a date/time context. If Interbase did
not accept strings as the values of parameters destined for storage in date/time fields, the resulting code
would be awkward. Consider the difference between the two Python snippets below, which insert a row containing
an integer and a timestamp into a table defined with the following DDL statement:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">timestamp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;now&#39;</span>
<span class="n">sqlWithMagicValues</span> <span class="o">=</span> <span class="s2">&quot;insert into test_table (i, t) values (?, &#39;</span><span class="si">%s</span><span class="s2">&#39;)&quot;</span> <span class="o">%</span> <span class="n">t</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span> <span class="n">sqlWithMagicValues</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,)</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;now&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span> <span class="s2">&quot;insert into test_table (i, t) values (?, ?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>If Interbase did not support weak parameter typing, string parameters that the database engine is to interpret
as “magic values” would have to be rolled into the SQL statement in a separate operation from the binding
of the rest of the parameters, as in the first Python snippet above. Implicit conversion of parameter values
from strings allows the consistency evident in the second snippet, which is both more readable and more
general.</p>
<p>It should be noted that Interbase does not perform the conversion from string itself. Instead, it passes that
responsibility to the database engine by changing the parameter metadata structure dynamically at the last
moment, then restoring the original state of the metadata structure after the database engine has performed
the conversion.</p>
<p>A secondary benefit is that when one uses Interbase to import large amounts of data from flat files into
the database, the incoming values need not necessarily be converted to their proper Python types before
being passed to the database engine. Eliminating this intermediate step may accelerate the import process
considerably, although other factors such as the chosen connection protocol and the deactivation of indexes
during the import are more consequential. For bulk import tasks, the database engine’s external tables also
deserve consideration. External tables can be used to suck semi-structured data from flat files directly
into the relational database without the intervention of an ad hoc conversion program.</p>
</section>
<section id="automatic-conversion-from-to-unicode">
<span id="index-17"></span><h3>Automatic conversion from/to unicode<a class="headerlink" href="#automatic-conversion-from-to-unicode" title="Permalink to this heading">¶</a></h3>
<p>In InterBase, every <cite>CHAR</cite>, <cite>VARCHAR</cite> or textual <cite>BLOB</cite> field can (or, better: must) have a <cite>character set</cite>
assigned. While it’s possible to define single character set for whole database, it’s also possible to
define different character set for each textual field. This information is used to correctly store the bytes
that make up the character string, and together with collation information (that defines the sort ordering
and uppercase conversions for a string) is vital for correct data manipulation, including automatic
transliteration between character sets when necessary.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because data also flow between server and client application, it’s vital that client will send data
encoded only in character set(s) that server expects. While it’s possible to leave this responsibility
completely on client application, it’s better when client and server settle on single character set
they would use for communication, especially when database operates with multiple character sets, or
uses character set that is not <cite>native</cite> for client application.</p>
<p>Character set for communication is specified using <cite>charset</cite> parameter in <a class="reference internal" href="reference.html#interbase.connect" title="interbase.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connection</span></code></a> call.</p>
<p>When <cite>connection charset</cite> is defined, all textual data returned from server are encoded in this charset,
and client application must ensure that all textual data sent to server are encoded only in this charset
as well.</p>
</div>
<p>Interbase helps with client side of this character set bargain by automatically converting <cite>unicode</cite> strings into
<cite>bytes/strings</cite> encoded in connection character set, and vice versa. However, developers are still
responsible that <cite>non-unicode</cite> strings passed to server are in correct encoding (because Interbase makes no
assumption about encoding of non-unicode strings, so it can’t recode them to connection charset).</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In case that <cite>connection charset</cite> is NOT defined at all, or <cite>NONE</cite> charset is specified, Interbase uses
<a class="reference external" href="https://docs.python.org/3/library/locale.html#locale.getpreferredencoding" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getpreferredencoding()</span></code></a> to determine encoding for conversions from/to <cite>unicode</cite>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There is one exception to automatic conversion: when character set OCTETS is defined for data column.
Values assigned to OCTETS columns are always passed <cite>as is</cite>, because they’re basically binary streams.
This has specific implications regarding Python version you use. Python 2.x <cite>native strings</cite> are <cite>bytes</cite>,
suitable for such binary streams, but Python 3 native strings are <cite>unicode</cite>, and you would probably
want to use <cite>bytes</cite> type instead. However, Interbase in this case doesn’t check the value type at all, so
you’ll not be warned if you’ll make a mistake and pass <cite>unicode</cite> to OCTETS column (unless you’ll pass
more bytes than column may hold, or you intend to store unicode that way).</p>
</div>
<p>Rules for automatic conversion depend on Python version you use:</p>
<ul class="simple">
<li><p>Native Python 2.x <cite>strings</cite> are passed to server as is, and developers must explicitly use <cite>unicode</cite>
strings to take advantage of automatic conversion. String values coming from server are converted to
<cite>unicode</cite> <strong>only</strong>:</p>
<ul>
<li><p>for data stored in database (i.e. not for string values returned by InterBase Service  and <cite>info</cite>
calls etc.).</p></li>
<li><p>when <cite>connection charset</cite> is specified.</p></li>
</ul>
</li>
<li><p>Native Python 3 strings are <cite>unicode</cite>, so conversion is fully automatic in both directions for all
textual data, i.e. including for string values returned by InterBase Service  and <cite>info</cite> calls etc.
When <cite>connection charset</cite> is not specified, Interbase uses <a class="reference external" href="https://docs.python.org/3/library/locale.html#locale.getpreferredencoding" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">locale.getpreferredencoding()</span></code></a> to determine
encoding for conversions from/to <cite>unicode</cite>.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Except for legacy databases that doesn’t have <cite>character set</cite> defined, <strong>always</strong> define character
set for your databases and specify <cite>connection charset</cite>. It will make your life much easier.</p>
</div>
</section>
<section id="working-with-blobs">
<span id="index-18"></span><span id="id3"></span><h3>Working with BLOBs<a class="headerlink" href="#working-with-blobs" title="Permalink to this heading">¶</a></h3>
<p>Interbase uses two types of BLOB values:</p>
<ul class="simple">
<li><p><strong>Materialized</strong> BLOB values are Python strings. This is the <strong>default</strong> type.</p></li>
<li><p><strong>Streamed</strong> BLOB values are <cite>file-like</cite> objects.</p></li>
</ul>
<p>Materialized BLOBs are easy to work with, but are not suitable for:</p>
<ul class="simple">
<li><p><strong>deferred loading</strong> of BLOBs. They’re called <cite>materialized</cite> because they’re always fetched from server
as part of row fetch. Fetching BLOB value means separate API calls (and network roundtrips), which may
slow down you application considerably.</p></li>
<li><p><strong>large values</strong>, as they are always stored in memory in full size.</p></li>
</ul>
<p>These drawbacks are addressed by <cite>stream</cite> BLOBs. Using BLOBs in <cite>stream</cite> mode is easy:</p>
<ul class="simple">
<li><p>For <strong>input</strong> values, simply use <a class="reference internal" href="#parameterized-statements"><span class="std std-ref">parameterized statement</span></a> and pass any
<cite>file-like</cite> object in place of BLOB parameter. The <cite>file-like</cite> object must implement only the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code> method, as no other method is used.</p></li>
<li><p>For <strong>output</strong> values, you have to call <a class="reference internal" href="reference.html#interbase.Cursor.set_stream_blob" title="interbase.Cursor.set_stream_blob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.set_stream_blob()</span></code></a> (or <a class="reference internal" href="reference.html#interbase.PreparedStatement.set_stream_blob" title="interbase.PreparedStatement.set_stream_blob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PreparedStatement.set_stream_blob()</span></code></a>)
method with specification of column name(s) that should be returned as <cite>file-like</cite> objects. Interbase then
returns <a class="reference internal" href="reference.html#interbase.BlobReader" title="interbase.BlobReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlobReader</span></code></a> instance instead string in place of returned BLOB value for these column(s).</p></li>
</ul>
<p>The <a class="reference internal" href="reference.html#interbase.BlobReader" title="interbase.BlobReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlobReader</span></code></a> instance is bound to particular BLOB value returned by server, so its life time
is limited. The actual BLOB value is not opened initially, so no additional API calls to server are made
if you’ll decide to ignore the value completely. You also don’t need to open the BLOB value explicitly,
as BLOB is opened automatically on first call to <a class="reference internal" href="reference.html#interbase.BlobReader.next" title="interbase.BlobReader.next"><code class="xref py py-meth docutils literal notranslate"><span class="pre">next()</span></code></a>, <a class="reference internal" href="reference.html#interbase.BlobReader.read" title="interbase.BlobReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a>,
<a class="reference internal" href="reference.html#interbase.BlobReader.readline" title="interbase.BlobReader.readline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">readline()</span></code></a>, <a class="reference internal" href="reference.html#interbase.BlobReader.readlines" title="interbase.BlobReader.readlines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">readlines()</span></code></a> or <a class="reference internal" href="reference.html#interbase.BlobReader.seek" title="interbase.BlobReader.seek"><code class="xref py py-meth docutils literal notranslate"><span class="pre">seek()</span></code></a>. However, it’s
good practice to <a class="reference internal" href="reference.html#interbase.BlobReader.close" title="interbase.BlobReader.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> the reader once you’re finished reading, as it’s likely that
Python’s garbage collector would call the <cite>__del__</cite> method too late, when fetch context is already gone,
and closing the reader would cause an error.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If BLOB was NOT CREATED as <cite>stream</cite> BLOB, calling <a class="reference internal" href="reference.html#interbase.BlobReader.seek" title="interbase.BlobReader.seek"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BlobReader.seek()</span></code></a> method will raise
<a class="reference internal" href="reference.html#interbase.DatabaseError" title="interbase.DatabaseError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DatabaseError</span></code></a> exception. <strong>This constraint is set by InterBase.</strong></p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When working with BLOB values, always have memory efficiency in mind, especially when you’re
processing huge quantity of rows with BLOB values at once. Materialized BLOB values may exhaust
your memory quickly, but using stream BLOBs may have impact on performance too, as new <cite>BlobReader</cite>
instance is created for each value fetched.</p>
</div>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">from</span> <span class="nn">cStringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;recreate table blob_test (a blob)&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># --- Materialized mode (str objects for both input and output) ---</span>
<span class="c1"># Insertion:</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into blob_test values (?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">,))</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into blob_test values (?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;ghijklmnop&#39;</span><span class="p">,))</span>
<span class="c1"># Retrieval:</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from blob_test&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;Materialized retrieval (as str):&#39;</span>
<span class="nb">print</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;delete from blob_test&quot;</span><span class="p">)</span>

<span class="c1"># --- Streaming mode (file-like objects for input; interbase.BlobReader objects for output) ---</span>

<span class="c1"># Insertion:</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into blob_test values (?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">),))</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into blob_test values (?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="s1">&#39;ghijklmnop&#39;</span><span class="p">),))</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into blob_test values (?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">f</span><span class="p">,))</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Retrieval using the &quot;file-like&quot; methods of BlobReader:</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from blob_test&quot;</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">set_stream_blob</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># Note the capital letter</span>

<span class="n">readerA</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Streaming retrieval (via interbase.BlobReader):&#39;</span>

<span class="c1"># Python &quot;file-like&quot; interface:</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.mode:    &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">mode</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.closed:   </span><span class="si">%s</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">closed</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.tell():   </span><span class="si">%d</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.read(2): &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.tell():   </span><span class="si">%d</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.read():  &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.tell():   </span><span class="si">%d</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.read():  &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span> <span class="s1">&#39;readerA.closed:   </span><span class="si">%s</span><span class="s1">&#39;</span>  <span class="o">%</span> <span class="n">readerA</span><span class="o">.</span><span class="n">closed</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Materialized</span> <span class="n">retrieval</span> <span class="p">(</span><span class="k">as</span> <span class="nb">str</span><span class="p">):</span>
<span class="p">[(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;ghijklmnop&#39;</span><span class="p">,)]</span>

<span class="n">Streaming</span> <span class="n">retrieval</span> <span class="p">(</span><span class="n">via</span> <span class="n">interbase</span><span class="o">.</span><span class="n">BlobReader</span><span class="p">):</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>    <span class="s2">&quot;rb&quot;</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>   <span class="kc">False</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">tell</span><span class="p">():</span>   <span class="mi">0</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> <span class="s2">&quot;ab&quot;</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">tell</span><span class="p">():</span>   <span class="mi">2</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">read</span><span class="p">():</span>  <span class="s2">&quot;cdef&quot;</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">tell</span><span class="p">():</span>   <span class="mi">6</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">read</span><span class="p">():</span>  <span class="s2">&quot;&quot;</span>
<span class="n">readerA</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>   <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="interbase-array-type">
<span id="index-19"></span><h3>InterBase ARRAY type<a class="headerlink" href="#interbase-array-type" title="Permalink to this heading">¶</a></h3>
<p>Interbase supports InterBase ARRAY data type. ARRAY values are represented as Python lists. On input, the Python
sequence (list or tuple) must be nested appropriately if the array field is multi-dimensional, and
the incoming sequence must not fall short of its maximum possible length (it will not be “padded”
implicitly–see below). On output, the lists will be nested if the database array has multiple dimensions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Database arrays have no place in a purely relational data model, which requires that data values be
atomized (that is, every value stored in the database must be reduced to elementary, non-decomposable
parts). The InterBase implementation of database arrays, like that of most relational database engines
that support this data type, is fraught with limitations.</p>
<p>Database arrays are of fixed size, with a predeclared number of dimensions (max. 16) and number of elements
per dimension. Individual array elements cannot be set to NULL / None, so the mapping between Python lists
(which have dynamic length and are therefore not normally “padded” with dummy values) and non-trivial
database arrays is clumsy.</p>
<p>Stored procedures cannot have array parameters.</p>
<p>Finally, many interface libraries, GUIs, and even the isql command line utility do not support database
arrays.</p>
<p>In general, it is preferable to avoid using database arrays unless you have a compelling reason.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select LANGUAGE_REQ from job where job_code=&#39;Eng&#39; and job_grade=3 and job_country=&#39;Japan&#39;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="go">([&#39;Japanese\n&#39;, &#39;Mandarin\n&#39;, &#39;English\n&#39;, &#39;\n&#39;, &#39;\n&#39;],)</span>
</pre></div>
</div>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:/temp/test.db&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">&quot;recreate table array_table (a int[3,4])&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">arrayIn</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
  <span class="p">]</span>

<span class="nb">print</span> <span class="s1">&#39;arrayIn:  </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">arrayIn</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into array_table values (?)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">arrayIn</span><span class="p">,))</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select a from array_table&quot;</span><span class="p">)</span>
<span class="n">arrayOut</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span> <span class="s1">&#39;arrayOut: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">arrayOut</span>

<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arrayIn</span><span class="p">:</span>  <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
<span class="n">arrayOut</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
</pre></div>
</div>
</section>
</section>
<section id="transanction-management">
<span id="index-20"></span><h2>Transanction management<a class="headerlink" href="#transanction-management" title="Permalink to this heading">¶</a></h2>
<p>For the sake of simplicity, Interbase lets the Python programmer ignore transaction management to the greatest
extent allowed by the Python Database API Specification 2.0. The specification says, “if the database
supports an auto-commit feature, this must be initially off”. At a minimum, therefore, it is necessary to
call the commit method of the connection in order to persist any changes made to the database.</p>
<p>Remember that because of ACID, every data manipulation operation in the InterBase database engine takes
place in the context of a transaction, including operations that are conceptually “read-only”, such as
a typical SELECT. The client programmer of Interbase establishes a transaction implicitly by using any SQL
execution method, such as <a class="reference internal" href="reference.html#interbase.Connection.execute_immediate" title="interbase.Connection.execute_immediate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_immediate()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Cursor.execute" title="interbase.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.execute()</span></code></a>, or
<a class="reference internal" href="reference.html#interbase.Cursor.callproc" title="interbase.Cursor.callproc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cursor.callproc()</span></code></a>.</p>
<p>Although Interbase allows the programmer to pay little attention to transactions, it also exposes the full
complement of the database engine’s advanced transaction control features: <a class="reference internal" href="#transaction-parameters">transaction parameters</a>,
<a class="reference internal" href="#retaining-transactions">retaining transactions</a>, <a class="reference internal" href="#savepoints">savepoints</a>, and <a class="reference internal" href="#id4">distributed transactions</a>.</p>
<section id="basics">
<h3>Basics<a class="headerlink" href="#basics" title="Permalink to this heading">¶</a></h3>
<p>When it comes to transactions, Python Database API 2.0 specify that <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object has to
respond to the following methods:</p>
<p><a class="reference internal" href="reference.html#interbase.Connection.commit" title="interbase.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.commit()</span></code></a></p>
<blockquote>
<div><p>Commit any pending transaction to the database. Note that if the database supports an auto-commit
feature, this must be initially off. An interface method may be provided to turn it back on. Database
modules that do not support transactions should implement this method with void functionality.</p>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.Connection.rollback" title="interbase.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.rollback()</span></code></a></p>
<blockquote>
<div><p>(optional) In case a database does provide transactions this method causes the the database to roll
back to the start of any pending transaction. <strong>Closing a connection without committing the changes
first will cause an implicit rollback to be performed.</strong></p>
</div></blockquote>
<p>In addition to the implicit transaction initiation required by Python Database API, Interbase allows the programmer
to start transactions explicitly via the <a class="reference internal" href="reference.html#interbase.Connection.begin" title="interbase.Connection.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.begin()</span></code></a> method. Also <code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.savepoint()</span></code>
method was added to provide support for <a class="reference external" href="https://docwiki.embarcadero.com/InterBase/2020/en/SAVEPOINT">InterBase SAVEPOINTs</a>.</p>
<p>But Python Database API 2.0 was created with assumption that connection can support only one transactions
per single connection. However, InterBase can support multiple independent transactions that can run
simultaneously within single connection / attachment to the database. This feature is very important,
as applications may require multiple transaction opened simultaneously to perform various tasks,
which would require to open multiple connections and thus consume more resources than necessary.</p>
<p>Interbase surfaces this InterBase feature by separating transaction management out from <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> into
separate <a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a> objects. To comply with Python DB API 2.0 requirements, <cite>Connection</cite> object
uses one <cite>Transaction</cite> instance as <a class="reference internal" href="reference.html#interbase.Connection.main_transaction" title="interbase.Connection.main_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">main</span> <span class="pre">transaction</span></code></a>, and delegates
<a class="reference internal" href="reference.html#interbase.Connection.begin" title="interbase.Connection.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">begin()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">savepoint()</span></code>, <a class="reference internal" href="reference.html#interbase.Connection.commit" title="interbase.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a>,
<a class="reference internal" href="reference.html#interbase.Connection.rollback" title="interbase.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code></a>, <a class="reference internal" href="reference.html#interbase.Connection.trans_info" title="interbase.Connection.trans_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trans_info()</span></code></a> and <a class="reference internal" href="reference.html#interbase.Connection.transaction_info" title="interbase.Connection.transaction_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transaction_info()</span></code></a>
calls to it.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>More about using multiple transactions with the same connection in separate
<a class="reference internal" href="#multiple-transactions"><span class="std std-ref">section</span></a>.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Most minimalistic transaction management -&gt; implicit start, only commit() and rollback()</span>
<span class="c1"># ========================================================================================</span>
<span class="c1">#</span>
<span class="c1"># Transaction is started implicitly</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Oz</span><span class="s1">&#39;,&#39;</span><span class="n">Crowns</span><span class="s1">&#39;)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># commits active transaction</span>
<span class="c1"># Again, transaction is started implicitly</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Barsoom</span><span class="s1">&#39;,&#39;</span><span class="n">XXX</span><span class="s1">&#39;)</span>
<span class="n">con</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span> <span class="c1"># rolls back active transaction</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Pellucidar</span><span class="s1">&#39;,&#39;</span><span class="n">Shells</span><span class="s1">&#39;)</span>

<span class="c1"># This will roll back the transaction</span>
<span class="c1"># because Python DB API 2.0 requires that closing connection</span>
<span class="c1"># with pending transaction must cause an implicit rollback</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="auto-commit">
<span id="index-21"></span><h3>Auto-commit<a class="headerlink" href="#auto-commit" title="Permalink to this heading">¶</a></h3>
<p>Interbase doesn’t support <cite>auto-commit</cite> feature directly, but developers may achieve the similar result
using <cite>explicit</cite> transaction start, taking advantage of <a class="reference internal" href="reference.html#interbase.Transaction.default_action" title="interbase.Transaction.default_action"><code class="xref py py-attr docutils literal notranslate"><span class="pre">default_action</span></code></a> and its
default value (<cite>commit</cite>).</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Oz</span><span class="s1">&#39;,&#39;</span><span class="n">Crowns</span><span class="s1">&#39;)</span>
<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="c1"># commits active transaction and starts new one</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Barsoom</span><span class="s1">&#39;,&#39;</span><span class="n">XXX</span><span class="s1">&#39;)</span>
<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="c1"># commits active transaction and starts new one</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Pellucidar</span><span class="s1">&#39;,&#39;</span><span class="n">Shells</span><span class="s1">&#39;)</span>

<span class="c1"># However, commit is required before connection is closed,</span>
<span class="c1"># because Python DB API 2.0 requires that closing connection</span>
<span class="c1"># with pending transaction must cause an implicit rollback</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="transaction-parameters">
<span id="index-22"></span><h3>Transaction parameters<a class="headerlink" href="#transaction-parameters" title="Permalink to this heading">¶</a></h3>
<p>The database engine offers the client programmer an optional facility called <cite>transaction parameter
buffers</cite> (TPBs) for tweaking the operating characteristics of the transactions he initiates. These
include characteristics such as whether the transaction has read and write access to tables, or
read-only access, and whether or not other simultaneously active transactions can share table access
with the transaction.</p>
<p>Connections have a <a class="reference internal" href="reference.html#interbase.Connection.default_tpb" title="interbase.Connection.default_tpb"><code class="xref py py-attr docutils literal notranslate"><span class="pre">default_tpb</span></code></a> attribute that can be changed to set the default
TPB for all transactions subsequently started on the connection. Alternatively, if the programmer
only wants to set the TPB for a single transaction, he can start a transaction explicitly via the
<a class="reference internal" href="reference.html#interbase.Connection.begin" title="interbase.Connection.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">begin()</span></code></a> method and pass a TPB for that single transaction.</p>
<p>For details about TPB construction, see the <a class="reference external" href="https://docwiki.embarcadero.com/InterBase/2020/en/API_Guide">InterBase API documentation</a>. In particular, the <cite>ibase.h</cite>
supplied with InterBase contains all possible TPB elements – single bytes that the C API defines as
constants whose names begin with <cite>isc_tpb_</cite>. Interbase makes all of those TPB constants available (under
the same names) as module-level constants. A transaction parameter buffer is handled in C as a character
array; Interbase requires that TPBs be constructed as Python <cite>strings</cite> (or <cite>bytes</cite> for Python 3). Since
the constants in the <cite>interbase.isc_tpb_*</cite> family are numbers, they can’t be simply concatenated to create
a TPB, but you may use utility function <strong>interbase.bs(byte_array)</strong> that accepts sequence of numbers and
returns <cite>string</cite> (P2) or <cite>bytes</cite> (P3).</p>
<p>For example next call returns TPB for typical <cite>READ COMMITED</cite> transaction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">TPB</span> <span class="o">=</span> <span class="n">bs</span><span class="p">([</span><span class="n">isc_tpb_version3</span><span class="p">,</span>
          <span class="n">isc_tpb_write</span><span class="p">,</span>
          <span class="n">isc_tpb_wait</span><span class="p">,</span>
          <span class="n">isc_tpb_read_committed</span><span class="p">,</span>
          <span class="n">isc_tpb_rec_version</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method requires good knowledge of <cite>tpc_block</cite> structure and proper order of various parameters,
as InterBase engine will raise an error when badly structured block would be used. Also definition of
<cite>table reservation</cite> parameters is uncomfortable as you’ll need to mix binary codes with table names
passed as Pascal strings (characters preceded by string length).</p>
</div>
<p>Interbase provides several predefined TPB’s for convenience:</p>
<ul>
<li><dl class="simple">
<dt><strong>ISOLATION_LEVEL_READ_COMMITED</strong></dt><dd><p>Read/Write READ COMMITED with <cite>record version</cite> and WAIT option. Isolation level with greatest
concurrent throughput. This is <strong>Default</strong> TPB.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This isolation level is optimal for transactions that write data and doesn’t require stable
snapshot of database for their operations (i.e. most operations are limited to individual rows).</p>
</div>
</li>
<li><dl>
<dt><strong>ISOLATION_LEVEL_READ_COMMITED_LEGACY</strong></dt><dd><p>Read/Write READ COMMITED with <cite>NO record version</cite> and WAIT option.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This isolation level emulates RDBMS that use locks instead multiversion control (MVC).
It’s not recommended to use it at all, except for legacy applications lazily ported from such
RDBMS to InterBase.</p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>ISOLATION_LEVEL_READ_COMMITED_RO</strong></dt><dd><p>Like <cite>ISOLATION_LEVEL_READ_COMMITED</cite>, but <strong>Read Only</strong>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>InterBase threats these transactions as <cite>pre-committed</cite>, so they are best option <strong>for long
running transactions that only read data</strong>.</p>
<p>Internally Interbase uses such transaction to read metadata from connected database. This internal
transaction is also available to developers for convenience as <a class="reference internal" href="reference.html#interbase.Connection.query_transaction" title="interbase.Connection.query_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.query_transaction</span></code></a>.</p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>ISOLATION_LEVEL_REPEATABLE_READ</strong> or <strong>ISOLATION_LEVEL_SNAPSHOT</strong></dt><dd><p>Read/Write SNAPSHOT (concurrency) with WAIT option.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This isolation level is necessary for transactions that process data in bulk, like reporting,
recalculations etc.</p>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>ISOLATION_LEVEL_SERIALIZABLE</strong> or <strong>ISOLATION_LEVEL_SNAPSHOT_TABLE_STABILITY</strong></dt><dd><p>Read/Write SNAPSHOT TABLE STABILITY (consistency) with WAIT option. Like REPEATABLE_READ/SNAPSHOT,
but locks whole tables for writes from other transactions. Isolation level with lowest concurrent
throughput.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because tables are locked for <cite>protected write</cite> (i.e. no other transaction can write until lock
is released) <strong>at time of first access</strong>, there is a great risk of <cite>deadlock</cite> between transactions.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To prevent deadlocks and increase concurrent throughput it’s recommended to use custom TPB’s with
<cite>fine-grained table access reservation</cite>.</p>
</div>
</dd>
</dl>
</li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Start transaction with default_tpb (ISOLATION_LEVEL_READ_COMMITED)</span>
<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from JOB&#39;</span><span class="p">)</span>
<span class="n">com</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Start using transactions in REPEATABLE READ (SNAPSHOT) isolation</span>
<span class="n">con</span><span class="o">.</span><span class="n">default_tpb</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">ISOLATION_LEVEL_REPEATABLE_READ</span>
<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from JOB&#39;</span><span class="p">)</span>
<span class="n">com</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Start THIS transaction as R/O READ COMMITTED</span>
<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">ISOLATION_LEVEL_READ_COMMITED_RO</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from JOB&#39;</span><span class="p">)</span>
<span class="n">com</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>For cases when predefined transaction parameter blocks are not suitable for your needs, Interbase offers utility
class <a class="reference internal" href="reference.html#interbase.TPB" title="interbase.TPB"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPB</span></code></a> for convenient and safe construction of custom <cite>tpb blocks</cite>. Simply create instance
of this class, set member attributes to required values and use either <a class="reference internal" href="reference.html#interbase.TPB.render" title="interbase.TPB.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rendered</span></code></a> binary
tpb block or <cite>TPB</cite> instance itself to set <cite>default_tpb</cite> or as parameter to <cite>begin()</cite>.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="c1"># Use TPB to construct valid transaction parameter block</span>
<span class="c1"># from the interbase.isc_tpb_* family.</span>
<span class="n">customTPB</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">TPB</span><span class="p">()</span>
<span class="n">customTPB</span><span class="o">.</span><span class="n">isolation_level</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_tpb_consistency</span> <span class="c1"># SERIALIZABLE</span>
<span class="n">customTPB</span><span class="o">.</span><span class="n">table_reservation</span><span class="p">[</span><span class="s2">&quot;MY_TABLE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_tpb_protected</span><span class="p">,</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_tpb_lock_write</span><span class="p">)</span>

<span class="c1"># Explicitly start a transaction with the custom TPB:</span>
<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="n">tpb</span><span class="o">=</span><span class="n">customTPB</span><span class="p">)</span>

<span class="c1"># For frequent use, it&#39;s better to use already assembled version of TPB</span>
<span class="n">customTPB</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">TPB</span><span class="p">()</span>
<span class="n">customTPB</span><span class="o">.</span><span class="n">access_mode</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_tpb_read</span>  <span class="c1"># read only</span>
<span class="n">customTPB</span><span class="o">.</span><span class="n">isolation_level</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_tpb_concurrency</span> <span class="c1"># SNAPSHOT</span>
<span class="n">customTPB</span> <span class="o">=</span> <span class="n">customTPB</span><span class="o">.</span><span class="n">render</span><span class="p">()</span> <span class="c1"># Create valid block according to current values of member attributes.</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
   <span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="n">tpb</span><span class="o">=</span><span class="n">customTPB</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to build only <cite>table reservation</cite> part of <cite>tpb</cite> (for example to add to various custom built
parameter blocks), you can use class <a class="reference internal" href="reference.html#interbase.TableReservation" title="interbase.TableReservation"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableReservation</span></code></a> instead <cite>TPB</cite>.</p>
</section>
<section id="getting-information-about-transaction">
<span id="index-23"></span><h3>Getting information about transaction<a class="headerlink" href="#getting-information-about-transaction" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a> object exposes two methods that return information about currently managed
active transaction (the same methods are exposed also by <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object for
<a class="reference internal" href="reference.html#interbase.Connection.main_transaction" title="interbase.Connection.main_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">main_transaction</span></code></a>):</p>
<p><a class="reference internal" href="reference.html#interbase.Transaction.transaction_info" title="interbase.Transaction.transaction_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transaction_info()</span></code></a> is a very thin wrapper around function <cite>isc_transaction_info()</cite>.
This method does not attempt to interpret its results except with regard to whether they are a string
or an integer.</p>
<p>A more convenient way to access the same functionality is via the <a class="reference internal" href="reference.html#interbase.Transaction.trans_info" title="interbase.Transaction.trans_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trans_info()</span></code></a> method,
which is high-level convenience wrapper around the <cite>transaction_info</cite> method that parses the output
of <cite>transaction_info</cite> into Python-friendly objects instead of returning raw binary buffers in the case
of complex result types.</p>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;localhost:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="c1"># Start transaction, so we can get information about it</span>
<span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>

<span class="n">info</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">trans_info</span><span class="p">([</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_id</span><span class="p">,</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_oldest_interesting</span><span class="p">,</span>
                       <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_oldest_snapshot</span><span class="p">,</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_oldest_active</span><span class="p">,</span>
                       <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_isolation</span><span class="p">,</span> <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_access</span><span class="p">,</span>
                       <span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_lock_timeout</span><span class="p">])</span>

<span class="nb">print</span> <span class="n">info</span>
<span class="nb">print</span> <span class="s2">&quot;TransactionID:&quot;</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_id</span><span class="p">]</span>
<span class="nb">print</span> <span class="s2">&quot;Oldest Interesting (OIT):&quot;</span><span class="p">,</span><span class="n">info</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_oldest_interesting</span><span class="p">]</span>
<span class="nb">print</span> <span class="s2">&quot;Oldest Snapshot:&quot;</span><span class="p">,</span><span class="n">info</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_oldest_snapshot</span><span class="p">]</span>
<span class="nb">print</span> <span class="s2">&quot;Oldest Active (OAT):&quot;</span><span class="p">,</span><span class="n">info</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_oldest_active</span><span class="p">]</span>
<span class="nb">print</span> <span class="s2">&quot;Isolation Level:&quot;</span><span class="p">,</span><span class="n">info</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_isolation</span><span class="p">]</span>
<span class="nb">print</span> <span class="s2">&quot;Access Mode:&quot;</span><span class="p">,</span><span class="n">info</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_access</span><span class="p">]</span>
<span class="nb">print</span> <span class="s2">&quot;Lock Timeout:&quot;</span><span class="p">,</span><span class="n">info</span><span class="p">[</span><span class="n">interbase</span><span class="o">.</span><span class="n">isc_info_tra_lock_timeout</span><span class="p">]</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">459</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">459</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">459</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
<span class="n">TransactionID</span><span class="p">:</span> <span class="mi">459</span>
<span class="n">Oldest</span> <span class="n">Interesting</span> <span class="p">(</span><span class="n">OIT</span><span class="p">):</span> <span class="mi">430</span>
<span class="n">Oldest</span> <span class="n">Snapshot</span><span class="p">:</span> <span class="mi">459</span>
<span class="n">Oldest</span> <span class="n">Active</span> <span class="p">(</span><span class="n">OAT</span><span class="p">):</span> <span class="mi">459</span>
<span class="n">Isolation</span> <span class="n">Level</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Access</span> <span class="n">Mode</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">Lock</span> <span class="n">Timeout</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Isolation level info values are available as Interbase constants <cite>isc_info_tra_consistency</cite>,
<cite>isc_info_tra_concurrency</cite> and <cite>isc_info_tra_read_committed</cite>. For <cite>read committed</cite>, a tuple
of two values is returned instead single value, where the second value is record version flag
<cite>isc_info_tra_no_rec_version</cite> or <cite>isc_info_tra_rec_version</cite>.</p>
<p>Access mode values are available as Interbase constants <cite>isc_info_tra_readonly</cite> and <cite>isc_info_tra_readwrite</cite>.</p>
</div>
</section>
<section id="retaining-transactions">
<span id="index-24"></span><h3>Retaining transactions<a class="headerlink" href="#retaining-transactions" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="reference.html#interbase.Transaction.commit" title="interbase.Transaction.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit()</span></code></a> and <a class="reference internal" href="reference.html#interbase.Transaction.rollback" title="interbase.Transaction.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code></a> methods accept an optional boolean
parameter <cite>retaining</cite> (<strong>default False</strong>) to indicate whether to recycle the transactional context of
the transaction being resolved by the method call.</p>
<p>If retaining is <cite>True</cite>, the infrastructural support for the transaction active at the time of the method
call will be “retained” (efficiently and transparently recycled) after the database server has committed
or rolled back the conceptual transaction.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In code that commits or rolls back frequently, “retaining” the transaction yields considerably better
performance. However, retaining transactions must be used cautiously because they can interfere with
the server’s ability to garbage collect old record versions. For details about this issue, read the
“Garbage” section of <a class="reference external" href="http://www.ibphoenix.com/resources/documents/search/doc_21">this document</a>
by Ann Harrison.</p>
</div>
<p>For more information about retaining transactions, see <cite>InterBase documentation</cite>.</p>
</section>
<section id="savepoints">
<span id="index-25"></span><h3>Savepoints<a class="headerlink" href="#savepoints" title="Permalink to this heading">¶</a></h3>
<p>Savepoints are named, intermediate control points within an open transaction that can later be rolled
back to, without affecting the preceding work. Multiple savepoints can exist within a single unresolved
transaction, providing “multi-level undo” functionality.</p>
<p>Although InterBase savepoints are fully supported from SQL alone via the <cite>SAVEPOINT ‘name’</cite> and
<cite>ROLLBACK TO ‘name’</cite> statements, Interbase also exposes savepoints at the Python API level for the sake
of convenience.</p>
<p>Call to method <code class="xref py py-meth docutils literal notranslate"><span class="pre">savepoint()</span></code> establishes a savepoint with the specified <cite>name</cite>. To roll back
to a specific savepoint, call the <a class="reference internal" href="reference.html#interbase.Transaction.rollback" title="interbase.Transaction.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback()</span></code></a> method and provide a value (the name of the
savepoint) for the optional <cite>savepoint</cite> parameter. If the savepoint parameter of <cite>rollback()</cite> is not
specified, the active transaction is cancelled in its entirety, as required by the Python Database API
Specification.</p>
<p>The following program demonstrates savepoint manipulation via the Interbase API, rather than raw SQL.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;recreate table test_savepoints (a integer)&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="nb">print</span> <span class="s1">&#39;Before the first savepoint, the contents of the table are:&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from test_savepoints&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into test_savepoints values (?)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">con</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;After savepoint A, the contents of the table are:&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from test_savepoints&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into test_savepoints values (?)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">con</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;After savepoint B, the contents of the table are:&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from test_savepoints&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into test_savepoints values (?)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">con</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;After savepoint C, the contents of the table are:&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from test_savepoints&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">con</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">savepoint</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;After rolling back to savepoint A, the contents of the table are:&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from test_savepoints&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">con</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
<span class="nb">print</span> <span class="s1">&#39;After rolling back entirely, the contents of the table are:&#39;</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from test_savepoints&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</pre></div>
</div>
<p>The output of the example program is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span> <span class="n">the</span> <span class="n">first</span> <span class="n">savepoint</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[]</span>
<span class="n">After</span> <span class="n">savepoint</span> <span class="n">A</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">savepoint</span> <span class="n">B</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">savepoint</span> <span class="n">C</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">rolling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">savepoint</span> <span class="n">A</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">rolling</span> <span class="n">back</span> <span class="n">entirely</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[]</span>
</pre></div>
</div>
</section>
<section id="using-multiple-transactions-with-the-same-connection">
<span id="multiple-transactions"></span><span id="index-26"></span><h3>Using multiple transactions with the same connection<a class="headerlink" href="#using-multiple-transactions-with-the-same-connection" title="Permalink to this heading">¶</a></h3>
<p>To use additional transactions that could run simultaneously with
<a class="reference internal" href="reference.html#interbase.Connection.main_transaction" title="interbase.Connection.main_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">main</span> <span class="pre">transaction</span></code></a> managed by <cite>Connection</cite>, create new
<a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a> object calling <a class="reference internal" href="reference.html#interbase.Connection.trans" title="interbase.Connection.trans"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.trans()</span></code></a> method. If you don’t specify the optional
<cite>default_tpb</cite> parameter, this new <cite>Transaction</cite> inherits the <a class="reference internal" href="reference.html#interbase.Connection.default_tpb" title="interbase.Connection.default_tpb"><code class="xref py py-attr docutils literal notranslate"><span class="pre">default_tpb</span></code></a> from
<cite>Connection</cite>. Physical transaction is not started when <cite>Transaction</cite> instance is created, but implicitly
when first SQL statement is executed, or explicitly via <a class="reference internal" href="reference.html#interbase.Transaction.begin" title="interbase.Transaction.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Transaction.begin()</span></code></a> call.</p>
<p>To execute statements in context of this additional transaction you have to use <cite>cursors</cite> obtained directly
from this <cite>Transaction</cite> instance calling its <a class="reference internal" href="reference.html#interbase.Transaction.cursor" title="interbase.Transaction.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cursor()</span></code></a> method, or call
<a class="reference internal" href="reference.html#interbase.Transaction.execute_immediate" title="interbase.Transaction.execute_immediate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Transaction.execute_immediate()</span></code></a> method.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">)</span>
<span class="c1"># Cursor for main_transaction context</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Create new READ ONLY READ COMMITTED transaction</span>
<span class="n">ro_transaction</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">ISOLATION_LEVEL_READ_COMMITED_RO</span><span class="p">)</span>
<span class="c1"># and cursor</span>
<span class="n">ro_cur</span> <span class="o">=</span> <span class="n">ro_transaction</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Oz</span><span class="s1">&#39;,&#39;</span><span class="n">Crowns</span><span class="s1">&#39;)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># commits main transaction</span>

<span class="c1"># Read data created by main transaction from second one</span>
<span class="n">ro_cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from COUNTRY where COUNTRY = `Oz`&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">ro_cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Insert more data, but don&#39;t commit</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into country values (&#39;</span><span class="n">Barsoom</span><span class="s1">&#39;,&#39;</span><span class="n">XXX</span><span class="s1">&#39;)</span>

<span class="c1"># Read data created by main transaction from second one</span>
<span class="n">ro_cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select * from COUNTRY where COUNTRY = `Barsoom`&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">ro_cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="distributed-transactions">
<span id="index-27"></span><span id="id4"></span><h3>Distributed Transactions<a class="headerlink" href="#distributed-transactions" title="Permalink to this heading">¶</a></h3>
<p>Distributed transactions are transactions that span multiple databases. Interbase provides this InterBase feature
through <a class="reference internal" href="reference.html#interbase.ConnectionGroup" title="interbase.ConnectionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionGroup</span></code></a> class. Instances of this class act as managers for <a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a>
object that is bound to multiple connections, and to <a class="reference internal" href="reference.html#interbase.Cursor" title="interbase.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">cursors</span></code></a> bound to it and connections
participated in group. That’s it, distributed transaction is fully independent from all other transactions,
main or secondary, of member connections.</p>
<p>To assemble a group of connections, you can either pass the sequence of <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> instances to
<a class="reference internal" href="reference.html#interbase.ConnectionGroup" title="interbase.ConnectionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionGroup</span></code></a> constructor, or add connections latter calling <a class="reference internal" href="reference.html#interbase.ConnectionGroup.add" title="interbase.ConnectionGroup.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionGroup.add()</span></code></a> method.</p>
<p>Any <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> could be a member of only one group, and attempt to add it to another one would
raise an exception. Also, <cite>Connection</cite> participating in group cannot be <a class="reference internal" href="reference.html#interbase.Connection.close" title="interbase.Connection.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">closed</span></code></a>
before it’s <a class="reference internal" href="reference.html#interbase.ConnectionGroup.remove" title="interbase.ConnectionGroup.remove"><code class="xref py py-meth docutils literal notranslate"><span class="pre">removed</span></code></a>  or whole group is
<a class="reference internal" href="reference.html#interbase.ConnectionGroup.disband" title="interbase.ConnectionGroup.disband"><code class="xref py py-meth docutils literal notranslate"><span class="pre">disbanded</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Never add more than one connection to the same database to the same <cite>ConnectionGroup</cite>!</p>
</div>
<p>Similarly to <a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a>, distributed transactions are managed through <a class="reference internal" href="reference.html#interbase.ConnectionGroup.begin" title="interbase.ConnectionGroup.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionGroup.begin()</span></code></a>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionGroup.savepoint()</span></code>. <a class="reference internal" href="reference.html#interbase.ConnectionGroup.commit" title="interbase.ConnectionGroup.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionGroup.commit()</span></code></a> and <a class="reference internal" href="reference.html#interbase.ConnectionGroup.rollback" title="interbase.ConnectionGroup.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionGroup.rollback()</span></code></a> methods.
Additionally, <cite>ConnectionGroup</cite> exposes method <a class="reference internal" href="reference.html#interbase.ConnectionGroup.prepare" title="interbase.ConnectionGroup.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> that explicitly initiates
the first phase of <cite>Two-Phase Commit Protocol</cite>. Transaction parameters are defined similarly to
<a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a> using <a class="reference internal" href="reference.html#interbase.ConnectionGroup.default_tpb" title="interbase.ConnectionGroup.default_tpb"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionGroup.default_tpb</span></code></a> or as optional parameter to
<a class="reference internal" href="reference.html#interbase.ConnectionGroup.begin" title="interbase.ConnectionGroup.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">begin()</span></code></a> call.</p>
<p>SQL statements that should belong to context of distributed transaction are executed via <a class="reference internal" href="reference.html#interbase.Cursor" title="interbase.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a>
instances acquired through <a class="reference internal" href="reference.html#interbase.ConnectionGroup.cursor" title="interbase.ConnectionGroup.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionGroup.cursor()</span></code></a> method, or calling
<a class="reference internal" href="reference.html#interbase.ConnectionGroup.execute_immediate" title="interbase.ConnectionGroup.execute_immediate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionGroup.execute_immediate()</span></code></a> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because <a class="reference internal" href="reference.html#interbase.Cursor" title="interbase.Cursor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cursor</span></code></a> instances can belong to only one <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>, the <a class="reference internal" href="reference.html#interbase.ConnectionGroup.cursor" title="interbase.ConnectionGroup.cursor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cursor()</span></code></a>
method has mandatory parameter <cite>connection</cite>, to specify to which member connection cursor should belong.</p>
</div>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>

<span class="c1"># First database</span>
<span class="n">con1</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE &#39;testdb-1.interbase&#39; USER &#39;SYSDBA&#39; PASSWORD &#39;masterkey&#39;&quot;</span><span class="p">)</span>
<span class="n">con1</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">&quot;recreate table T (PK integer, C1 integer)&quot;</span><span class="p">)</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Second database</span>
<span class="n">con2</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE &#39;testdb-2,interbase&#39; USER &#39;SYSDBA&#39; PASSWORD &#39;masterkey&#39;&quot;</span><span class="p">)</span>
<span class="n">con2</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">&quot;recreate table T (PK integer, C1 integer)&quot;</span><span class="p">)</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Create connection group</span>
<span class="n">cg</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">ConnectionGroup</span><span class="p">((</span><span class="n">con1</span><span class="p">,</span><span class="n">con2</span><span class="p">))</span>

<span class="c1"># Prepare Group cursors for each connection</span>
<span class="n">gc1</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con1</span><span class="p">)</span>
<span class="n">gc2</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con2</span><span class="p">)</span>

<span class="c1"># Connection cursors to check content of databases</span>
<span class="n">q</span> <span class="o">=</span> <span class="s1">&#39;select * from T order by pk&#39;</span>

<span class="n">cc1</span> <span class="o">=</span> <span class="n">con1</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">cc1</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="n">cc2</span> <span class="o">=</span> <span class="n">con2</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">cc2</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="nb">print</span> <span class="s2">&quot;Distributed transaction: COMMIT&quot;</span>
<span class="c1">#      ===============================</span>
<span class="n">gc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into t (pk) values (1)&#39;</span><span class="p">)</span>
<span class="n">gc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into t (pk) values (1)&#39;</span><span class="p">)</span>
<span class="n">cg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db1:&#39;</span><span class="p">,</span><span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db2:&#39;</span><span class="p">,</span><span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="nb">print</span> <span class="s2">&quot;Distributed transaction: PREPARE + COMMIT&quot;</span>
<span class="c1">#      =========================================</span>
<span class="n">gc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into t (pk) values (2)&#39;</span><span class="p">)</span>
<span class="n">gc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into t (pk) values (2)&#39;</span><span class="p">)</span>
<span class="n">cg</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
<span class="n">cg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db1:&#39;</span><span class="p">,</span><span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db2:&#39;</span><span class="p">,</span><span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="nb">print</span> <span class="s2">&quot;Distributed transaction: SAVEPOINT + ROLLBACK to it&quot;</span>
<span class="c1">#      ===================================================</span>
<span class="n">gc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into t (pk) values (3)&#39;</span><span class="p">)</span>
<span class="n">cg</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">&#39;CG_SAVEPOINT&#39;</span><span class="p">)</span>
<span class="n">gc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;insert into t (pk) values (3)&#39;</span><span class="p">)</span>
<span class="n">cg</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">savepoint</span><span class="o">=</span><span class="s1">&#39;CG_SAVEPOINT&#39;</span><span class="p">)</span>

<span class="c1"># check it - via group cursors, as transaction is still active</span>
<span class="n">gc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db1:&#39;</span><span class="p">,</span><span class="n">gc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">gc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db2:&#39;</span><span class="p">,</span><span class="n">gc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="nb">print</span> <span class="s2">&quot;Distributed transaction: ROLLBACK&quot;</span>
<span class="c1">#      =================================</span>
<span class="n">cg</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db1:&#39;</span><span class="p">,</span><span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db2:&#39;</span><span class="p">,</span><span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="nb">print</span> <span class="s2">&quot;Distributed transaction: EXECUTE_IMMEDIATE&quot;</span>
<span class="c1">#      ==========================================</span>
<span class="n">cg</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s1">&#39;insert into t (pk) values (3)&#39;</span><span class="p">)</span>
<span class="n">cg</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db1:&#39;</span><span class="p">,</span><span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;db2:&#39;</span><span class="p">,</span><span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Finalize</span>
<span class="n">con1</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
<span class="n">con1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">COMMIT</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">PREPARE</span> <span class="o">+</span> <span class="n">COMMIT</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">SAVEPOINT</span> <span class="o">+</span> <span class="n">ROLLBACK</span> <span class="n">to</span> <span class="n">it</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">ROLLBACK</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">EXECUTE_IMMEDIATE</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<section id="transaction-context-manager">
<span id="id5"></span><h3>Transaction Context Manager<a class="headerlink" href="#transaction-context-manager" title="Permalink to this heading">¶</a></h3>
<p>Interbase provides context manager <a class="reference internal" href="reference.html#interbase.TransactionContext" title="interbase.TransactionContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransactionContext</span></code></a> that allows automatic transaction
management using <a class="reference external" href="https://docs.python.org/3/reference/compound_stmts.html#with" title="(in Python v3.11)"><span>The with statement</span></a>. It can work with any object that supports <cite>begin()</cite>, <cite>commit()</cite> and
<cite>rollback()</cite> methods, i.e. <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="reference.html#interbase.ConnectionGroup" title="interbase.ConnectionGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionGroup</span></code></a> or <a class="reference internal" href="reference.html#interbase.Transaction" title="interbase.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a>.</p>
<p>It starts transaction when WITH block is entered and commits it if no exception occurs within it, or
calls <cite>rollback()</cite> otherwise. Exceptions raised in WITH block are never suppressed.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="c1"># Uses default main transaction</span>
<span class="k">with</span> <span class="n">TransactionContext</span><span class="p">(</span><span class="n">con</span><span class="p">):</span>
   <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
   <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into T (PK,C1) values (1,&#39;TXT&#39;)&quot;</span><span class="p">)</span>

<span class="c1"># Uses separate transaction</span>
<span class="k">with</span> <span class="n">TransactionContext</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">trans</span><span class="p">())</span> <span class="k">as</span> <span class="n">tr</span><span class="p">:</span>
   <span class="n">cur</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
   <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into T (PK,C1) values (2,&#39;AAA&#39;)&quot;</span><span class="p">)</span>

<span class="c1"># Uses connection group (distributed transaction)</span>
<span class="n">con2</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;remote:employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="n">cg</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">ConnectionGroup</span><span class="p">((</span><span class="n">con</span><span class="p">,</span><span class="n">con2</span><span class="p">))</span>
<span class="k">with</span> <span class="n">TransactionContext</span><span class="p">(</span><span class="n">cg</span><span class="p">):</span>
   <span class="n">cur1</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
   <span class="n">cur2</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con2</span><span class="p">)</span>
   <span class="n">cur1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into T (PK,C1) values (3,&#39;Local&#39;)&quot;</span><span class="p">)</span>
   <span class="n">cur2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;insert into T (PK,C1) values (3,&#39;Remote&#39;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="database-events">
<span id="index-28"></span><h2>Database Events<a class="headerlink" href="#database-events" title="Permalink to this heading">¶</a></h2>
<section id="what-they-are">
<h3>What they are<a class="headerlink" href="#what-they-are" title="Permalink to this heading">¶</a></h3>
<p>The InterBase engine features a distributed, interprocess communication mechanism based on messages
called <cite>database events</cite>. A database event is a message passed from a trigger or stored procedure
to an application to announce the occurrence of a specified condition or action, usually a database
change such as an insertion, modification, or deletion of a record. The InterBase event mechanism enables
applications to respond to actions and database changes made by other, concurrently running applications
without the need for those applications to communicate directly with one another, and without incurring
the expense of CPU time required for periodic polling to determine if an event has occurred.</p>
</section>
<section id="why-use-them">
<h3>Why use them<a class="headerlink" href="#why-use-them" title="Permalink to this heading">¶</a></h3>
<p>Anything that can be accomplished with database events can also be implemented using other techniques,
so why bother with events? Since you’ve chosen to write database-centric programs in Python rather than
assembly language, you probably already know the answer to this question, but let’s illustrate.</p>
<p>A typical application for database events is the handling of administrative messages. Suppose you have
an administrative message database with a <cite>message’s</cite> table, into which various applications insert
timestamped status reports. It may be desirable to react to these messages in diverse ways, depending
on the status they indicate: to ignore them, to initiate the update of dependent databases upon their
arrival, to forward them by e-mail to a remote administrator, or even to set off an alarm so that on-site
administrators will know a problem has occurred.</p>
<p>It is undesirable to tightly couple the program whose status is being reported (the <cite>message producer</cite>) to
the program that handles the status reports (the <cite>message handler</cite>). There are obvious losses of flexibility
in doing so. For example, the message producer may run on a separate machine from the administrative
message database and may lack access rights to the downstream reporting facilities (e.g., network access
to the SMTP server, in the case of forwarded e-mail notifications). Additionally, the actions required
to handle status reports may themselves be time-consuming and error-prone, as in accessing a remote network
to transmit e-mail.</p>
<p>In the absence of database event support, the message handler would probably be implemented via <cite>polling</cite>.
Polling is simply the repetition of a check for a condition at a specified interval. In this case,
the message handler would check in an infinite loop to see whether the most recent record in the <cite>messages</cite>
table was more recent than the last message it had handled. If so, it would handle the fresh message(s);
if not, it would go to sleep for a specified interval, then loop.</p>
<p>The <cite>polling-based</cite> implementation of the message handler is fundamentally flawed. Polling is a form
of <a class="reference external" href="http://www.catb.org/jargon/html/B/busy-wait.html">busy-wait</a>; the check for new messages is performed at the specified interval, regardless of the actual
activity level of the message producers. If the polling interval is lengthy, messages might not be handled
within a reasonable time period after their arrival; if the polling interval is brief, the message handler
program (and there may be many such programs) will waste a large amount of CPU time on unnecessary checks.</p>
<p>The database server is necessarily aware of the exact moment when a new message arrives. Why not let
the message handler program request that the database server send it a notification when a new message
arrives? The message handler can then efficiently sleep until the moment its services are needed. Under
this <cite>event-based</cite> scheme, the message handler becomes aware of new messages at the instant they arrive,
yet it does not waste CPU time checking in vain for new messages when there are none available.</p>
</section>
<section id="how-events-are-exposed">
<h3>How events are exposed<a class="headerlink" href="#how-events-are-exposed" title="Permalink to this heading">¶</a></h3>
<ol class="arabic">
<li><p>Server Process (“An event just occurred!”)</p>
<p>To notify any interested listeners that a specific event has
occurred, issue the <cite>POST_EVENT</cite> statement from Stored Procedure
or Trigger. The <cite>POST_EVENT</cite> statement has one parameter: the name
of the event to post. In the preceding example of the administrative
message database, <cite>POST_EVENT</cite> might be used from an <cite>after insert</cite>
trigger on the <cite>messages</cite> table, like this:</p>
<div class="highlight-s notranslate"><div class="highlight"><pre><span></span><span class="n">create</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">trig_messages_handle_insert</span>
<span class="w">  </span><span class="n">for</span><span class="w"> </span><span class="n">messages</span>
<span class="w">    </span><span class="n">after</span><span class="w"> </span><span class="n">insert</span>
<span class="n">as</span>
<span class="n">begin</span>
<span class="w">  </span><span class="n">POST_EVENT</span><span class="w"> </span><span class="s">&#39;new_message&#39;</span><span class="p">;</span>
<span class="n">end</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The physical notification of the client process does not
occur until the transaction in which the <cite>POST_EVENT</cite> took place is
actually committed. Therefore, multiple events may <em>conceptually</em>
occur before the client process is <em>physically</em> informed of even one
occurrence. Furthermore, the database engine makes no guarantee that
clients will be informed of events in the same groupings in which they
conceptually occurred. If, within a single transaction, an event named
<cite>event_a</cite> is posted once and an event named <cite>event_b</cite> is posted once,
the client may receive those posts in separate “batches”, despite the
fact that they occurred in the same conceptual unit (a single
transaction). This also applies to multiple occurrences of <em>the same</em>
event within a single conceptual unit: the physical notifications may
arrive at the client separately.</p>
</div>
</li>
<li><p>Client Process (“Send me a message when an event occurs.”)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t care about the gory details of event notification,
skip to the section that describes Interbase’s Python-level event handling
API.</p>
</div>
<p>The InterBase C client library offers two forms of event notification.
The first form is <em>synchronous</em> notification, by way of the function
<code class="xref c c-func docutils literal notranslate"><span class="pre">isc_wait_for_event()</span></code>. This form is admirably simple for a C programmer
to use, but is inappropriate as a basis for Interbase’s event support,
chiefly because it’s not sophisticated enough to serve as the basis for
a comfortable Python-level API. The other form of event notification
offered by the database client library is <em>asynchronous</em>, by way of the
functions <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> (note that the name of that function
is misspelled), <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_cancel_events()</span></code>, and others. The details are
as nasty as they are numerous, but the essence of using asynchronous
notification from C is as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Call <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_event_block()</span></code> to create a formatted binary buffer that
will tell the server which events the client wants to listen for.</p></li>
<li><p>Call <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> (passing the buffer created in the previous
step) to inform the server that the client is ready to receive event
notifications, and provide a callback that will be asynchronously
invoked when one or more of the registered events occurs.</p></li>
<li><p>[The thread that called <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> to initiate event
listening must now do something else.]</p></li>
<li><p>When the callback is invoked (the database client library starts a
thread dedicated to this purpose), it can use the <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_event_counts()</span></code>
function to determine how many times each of the registered events has
occurred since the last call to <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_event_counts()</span></code> (if any).</p></li>
<li><p>[The callback thread should now “do its thing”, which may include
communicating with the thread that called <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code>.]</p></li>
<li><p>When the callback thread is finished handling an event
notification, it must call <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> again in order to receive
future notifications. Future notifications will invoke the callback
again, effectively “looping” the callback thread back to Step 4.</p></li>
</ol>
</div></blockquote>
</li>
</ol>
</section>
<section id="api-for-python-developers">
<h3>API for Python developers<a class="headerlink" href="#api-for-python-developers" title="Permalink to this heading">¶</a></h3>
<p>The Interbase database event API is comprised of the following: the method <a class="reference internal" href="reference.html#interbase.Connection.event_conduit" title="interbase.Connection.event_conduit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.event_conduit()</span></code></a>
and the class <a class="reference internal" href="reference.html#interbase.EventConduit" title="interbase.EventConduit"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventConduit</span></code></a>.</p>
<p>The <a class="reference internal" href="reference.html#interbase.EventConduit" title="interbase.EventConduit"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventConduit</span></code></a> class serve as “conduit” through which database event notifications will flow
into the Python program. It’s not designed to be instantiated directly by the Python programmer. Instead,
use the <a class="reference internal" href="reference.html#interbase.Connection.event_conduit" title="interbase.Connection.event_conduit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.event_conduit()</span></code></a> method to create <cite>EventConduit</cite> instances. <cite>event_conduit</cite> is
a method of <cite>Connection</cite> rather than a module-level function or a class constructor because the database
engine deals with events in the context of a particular database (after all, <cite>POST_EVENT</cite> must be issued
by a stored procedure or a trigger).</p>
<p><a class="reference internal" href="reference.html#interbase.Connection.event_conduit" title="interbase.Connection.event_conduit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.event_conduit()</span></code></a> takes a sequence of string event names as parameter, and returns
<a class="reference internal" href="reference.html#interbase.EventConduit" title="interbase.EventConduit"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventConduit</span></code></a> instance.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To start listening for events it’s necessary to call <a class="reference internal" href="reference.html#interbase.EventConduit.begin" title="interbase.EventConduit.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">EventConduit.begin()</span></code></a>
method or use EventConduit’s context manager interface.</p>
</div>
<p>Immediately when <a class="reference internal" href="reference.html#interbase.EventConduit.begin" title="interbase.EventConduit.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">begin()</span></code></a> method is called, EventConduit starts to accumulate notifications
of any events that occur within the conduit’s internal queue until the conduit is closed either explicitly (via the
<a class="reference internal" href="reference.html#interbase.EventConduit.close" title="interbase.EventConduit.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> method) or implicitly (via garbage collection).</p>
<p>Notifications about events are acquired through call to <a class="reference internal" href="reference.html#interbase.EventConduit.wait" title="interbase.EventConduit.wait"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait()</span></code></a> method, that blocks
the calling thread until at least one of the events occurs, or the specified <cite>timeout</cite> (if any) expires,
and returns <cite>None</cite> if the wait timed out, or a dictionary that maps <cite>event_name -&gt; event_occurrence_count</cite>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><cite>EventConduit</cite> can act as context manager that ensures execution of <a class="reference internal" href="reference.html#interbase.EventConduit.begin" title="interbase.EventConduit.begin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">begin()</span></code></a> and <a class="reference internal" href="reference.html#interbase.EventConduit.close" title="interbase.EventConduit.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> methods.
It’s strongly advised to use the <cite>EventConduit</cite> with the <cite>with</cite> statement.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">connection</span><span class="o">.</span><span class="n">event_conduit</span><span class="p">(</span> <span class="p">(</span><span class="s1">&#39;event_a&#39;</span><span class="p">,</span> <span class="s1">&#39;event_b&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">as</span> <span class="n">conduit</span><span class="p">:</span>
    <span class="n">events</span> <span class="o">=</span> <span class="n">conduit</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="n">process_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to drop notifications accumulated so far by conduit, call <a class="reference internal" href="reference.html#interbase.EventConduit.flush" title="interbase.EventConduit.flush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">EventConduit.flush()</span></code></a> method.</p>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Prepare database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE &#39;event_test.interbase&#39; USER &#39;SYSDBA&#39; PASSWORD &#39;masterkey&#39;&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">&quot;CREATE TABLE T (PK Integer, C1 Integer)&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;CREATE TRIGGER EVENTS_AU FOR T ACTIVE</span>
<span class="s2">BEFORE UPDATE POSITION 0</span>
<span class="s2">AS</span>
<span class="s2">BEGIN</span>
<span class="s2">   if (old.C1 &lt;&gt; new.C1) then</span>
<span class="s2">      post_event &#39;c1_updated&#39; ;</span>
<span class="s2">END&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;CREATE TRIGGER EVENTS_AI FOR T ACTIVE</span>
<span class="s2">AFTER INSERT POSITION 0</span>
<span class="s2">AS</span>
<span class="s2">BEGIN</span>
<span class="s2">   if (new.c1 = 1) then</span>
<span class="s2">     post_event &#39;insert_1&#39; ;</span>
<span class="s2">   else if (new.c1 = 2) then</span>
<span class="s2">     post_event &#39;insert_2&#39; ;</span>
<span class="s2">   else if (new.c1 = 3) then</span>
<span class="s2">     post_event &#39;insert_3&#39; ;</span>
<span class="s2">   else</span>
<span class="s2">     post_event &#39;insert_other&#39; ;</span>
<span class="s2">END&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Utility function</span>
<span class="k">def</span> <span class="nf">send_events</span><span class="p">(</span><span class="n">command_list</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">command_list</span><span class="p">:</span>
      <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
   <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="nb">print</span> <span class="s2">&quot;One event&quot;</span>
<span class="c1">#      =========</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">,]])</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">event_conduit</span><span class="p">([</span><span class="s1">&#39;insert_1&#39;</span><span class="p">])</span>
<span class="n">events</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="n">events</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span> <span class="n">e</span>

<span class="nb">print</span> <span class="s2">&quot;Multiple events&quot;</span>
<span class="c1">#      ===============</span>
<span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,3)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,2)&quot;</span><span class="p">,]</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">cmds</span><span class="p">])</span>
<span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">event_conduit</span><span class="p">([</span><span class="s1">&#39;insert_1&#39;</span><span class="p">,</span><span class="s1">&#39;insert_3&#39;</span><span class="p">])</span>
<span class="n">events</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="n">events</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span> <span class="n">e</span>

<span class="nb">print</span> <span class="s2">&quot;20 events&quot;</span>
<span class="c1">#      =========</span>
<span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,3)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;insert into T (PK,C1) values (1,2)&quot;</span><span class="p">,]</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">cmds</span><span class="p">])</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">event_conduit</span><span class="p">([</span><span class="s1">&#39;insert_1&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;J&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;insert_3&#39;</span><span class="p">])</span>
<span class="n">events</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="n">events</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span> <span class="n">e</span>

<span class="nb">print</span> <span class="s2">&quot;Flush events&quot;</span>
<span class="c1">#      ============</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">,]])</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">event_conduit</span><span class="p">([</span><span class="s1">&#39;insert_1&#39;</span><span class="p">])</span>
<span class="n">events</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
<span class="n">send_events</span><span class="p">([</span><span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">,</span>
             <span class="s2">&quot;insert into T (PK,C1) values (1,1)&quot;</span><span class="p">])</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">events</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="n">events</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="nb">print</span> <span class="n">e</span>

<span class="c1"># Finalize</span>
<span class="n">con</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">One</span> <span class="n">event</span>
<span class="p">{</span><span class="s1">&#39;insert_1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">Multiple</span> <span class="n">events</span>
<span class="p">{</span><span class="s1">&#39;insert_3&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;insert_1&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="mi">20</span> <span class="n">events</span>
<span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;insert_1&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;insert_3&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">Flush</span> <span class="n">events</span>
<span class="p">{</span><span class="s1">&#39;insert_1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="working-with-services">
<span id="index-29"></span><span id="id6"></span><h2>Working with Services<a class="headerlink" href="#working-with-services" title="Permalink to this heading">¶</a></h2>
<p>Database server maintenance tasks such as user management, load monitoring, and database backup have
traditionally been automated by scripting the command-line tools <strong class="program">gbak</strong>, <strong class="program">gfix</strong>,
<strong class="program">gsec</strong>, and <strong class="program">gstat</strong>.</p>
<p>The API presented to the client programmer by these utilities is inelegant because they are, after all,
command-line tools rather than native components of the client language. To address this problem, InterBase
has a facility called the <cite>Services API</cite>, which exposes a uniform interface to the administrative
functionality of the traditional command-line tools.</p>
<p>The native Services API, though consistent, is much lower-level than a Pythonic API. If the native version
were exposed directly, accomplishing a given task would probably require more Python code than scripting
the traditional command-line tools. For this reason, Interbase presents its own abstraction over the native API
via the <a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interbase.services</span></code></a> module.</p>
<section id="services-api-connections">
<h3>Services API Connections<a class="headerlink" href="#services-api-connections" title="Permalink to this heading">¶</a></h3>
<p>All Services API operations are performed in the context of a <cite>connection</cite> to a specific database server,
represented by the <a class="reference internal" href="reference.html#interbase.services.Connection" title="interbase.services.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">interbase.services.Connection</span></code></a> class. Similarly to database connections, Interbase provides
<a class="reference internal" href="reference.html#interbase.services.connect" title="interbase.services.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> constructor function to create such connections.</p>
<p>This constructor has three keyword parameters:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">host<span class="colon">:</span></dt>
<dd class="field-odd"><p>The network name of the computer on which the database server is running.</p>
</dd>
<dt class="field-even">user<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the database user under whose authority the maintenance tasks are to be performed.</p>
</dd>
<dt class="field-odd">password<span class="colon">:</span></dt>
<dd class="field-odd"><p>User’s password.</p>
</dd>
</dl>
</div></blockquote>
<p>Since maintenance operations are most often initiated by an administrative user on the same computer as
the database server, <cite>host</cite> defaults to the local computer, and <cite>user</cite> defaults to <cite>SYSDBA</cite>.</p>
<p>The three calls to <a class="reference internal" href="reference.html#interbase.services.connect" title="interbase.services.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">interbase.services.connect()</span></code></a> in the following program are equivalent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Like database connections, it’s good practice to <a class="reference internal" href="reference.html#interbase.services.Connection.close" title="interbase.services.Connection.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> them when you don’t need them
anymore.</p>
</div>
<p><a class="reference internal" href="reference.html#interbase.services.Connection" title="interbase.services.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object provides number of methods that could be divided into several groups:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#server-configuration-and-state">Server Configuration and State</a>: To get information about server configuration, active attachments or
users, or to get content of server log.</p></li>
<li><p><a class="reference internal" href="#database-options">Database options</a>: To set various database parameters like size of page cache, access mode or SQL dialect.</p></li>
<li><p><a class="reference internal" href="#database-maintenance">Database maintenance</a>: To perform backup, restore, validation or other database maintenance tasks.</p></li>
<li><p><a href="#id10"><span class="problematic" id="id11">`User maintanance`_</span></a>: To get or change information about users defined in security database, to create new
or remove users.</p></li>
<li><p><a href="#id12"><span class="problematic" id="id13">`Trace service`_</span></a>: To start, stop, pause/resume or list InterBase <cite>trace sessions</cite>.</p></li>
<li><p><a class="reference internal" href="#text-ouput-from-services">Text ouput from Services</a>: Some services like <cite>backup</cite> or <cite>trace</cite> may return significant amount of text.
This output is not returned directly by method that starts the service, but through separate methods that
emulate read from text file, or provide <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a> support on <cite>Connection</cite>.</p></li>
</ul>
</section>
<section id="server-configuration-and-state">
<h3>Server Configuration and State<a class="headerlink" href="#server-configuration-and-state" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_service_manager_version" title="interbase.services.Connection.get_service_manager_version"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_service_manager_version()</span></code></a></p>
<blockquote>
<div><p>To help client programs adapt to version changes, the service manager exposes its version number as
an integer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_service_manager_version</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p><cite>interbase.services</cite> is a thick wrapper of the Services API that can shield its users from changes in
the underlying C API, so this method is unlikely to be useful to the typical Python client programmer.</p>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_server_version" title="interbase.services.Connection.get_server_version"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_server_version()</span></code></a></p>
<blockquote>
<div><p>Returns the server’s version string</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_server_version</span><span class="p">()</span>
</pre></div>
</div>
<p>At first glance, this method appears to duplicate the functionality of the
<a class="reference internal" href="reference.html#interbase.Connection.server_version" title="interbase.Connection.server_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">interbase.Connection.server_version</span></code></a> property, but when working with InterBase, there is a difference.
<a class="reference internal" href="reference.html#interbase.Connection.server_version" title="interbase.Connection.server_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">interbase.Connection.server_version</span></code></a> is based on a C API call (<cite>isc_database_info()</cite>) that existed long
before the introduction of the Services API. Some programs written before the advent of InterBase test
the version number in the return value of <cite>isc_database_info()</cite>, and refuse to work if it indicates that
the server is too old.</p>
<p>InterBase addresses this problem by making <cite>isc_database_info()</cite> return a “pseudo-InterBase” version
number, whereas the Services API returns the true InterBase version, as shown:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;Interbase-compatible version string:&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">server_version</span>
<span class="n">svcCon</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;Actual InterBase version string:     &#39;</span><span class="p">,</span> <span class="n">svcCon</span><span class="o">.</span><span class="n">get_server_version</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_architecture" title="interbase.services.Connection.get_architecture"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_architecture()</span></code></a></p>
<blockquote>
<div><p>Returns platform information for the server, including hardware architecture and operating system family.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_architecture</span><span class="p">()</span>
<span class="go">InterBase/linux AMD64</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_home_directory" title="interbase.services.Connection.get_home_directory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_home_directory()</span></code></a></p>
<blockquote>
<div><p>Returns the equivalent of the RootDirectory setting from <code class="file docutils literal notranslate"><span class="pre">interbase.conf</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_home_directory</span><span class="p">()</span>
<span class="go">/opt/interbase/</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_security_database_path" title="interbase.services.Connection.get_security_database_path"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_security_database_path()</span></code></a></p>
<blockquote>
<div><p>Returns the location of the server’s core security database, which contains user definitions and such.
Name of this database is <code class="file docutils literal notranslate"><span class="pre">admin.ib</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_security_database_path</span><span class="p">()</span>
<span class="go">/opt/interbase/security2.interbase</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_lock_file_directory" title="interbase.services.Connection.get_lock_file_directory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_lock_file_directory()</span></code></a></p>
<blockquote>
<div><p>Returns the directory location for InterBase lock files.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_lock_file_directory</span><span class="p">()</span>
<span class="go">/tmp/interbase/</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_server_capabilities" title="interbase.services.Connection.get_server_capabilities"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_server_capabilities()</span></code></a></p>
<blockquote>
<div><p>Returns tuple of capability info codes for each capability reported by InterBase server. Following
constants are defined in <a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interbase.services</span></code></a> for convenience:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.services.CAPABILITY_MULTI_CLIENT" title="interbase.services.CAPABILITY_MULTI_CLIENT"><code class="xref py py-data docutils literal notranslate"><span class="pre">CAPABILITY_MULTI_CLIENT</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.CAPABILITY_REMOTE_HOP" title="interbase.services.CAPABILITY_REMOTE_HOP"><code class="xref py py-data docutils literal notranslate"><span class="pre">CAPABILITY_REMOTE_HOP</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.CAPABILITY_SERVER_CONFIG" title="interbase.services.CAPABILITY_SERVER_CONFIG"><code class="xref py py-data docutils literal notranslate"><span class="pre">CAPABILITY_SERVER_CONFIG</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.CAPABILITY_QUOTED_FILENAME" title="interbase.services.CAPABILITY_QUOTED_FILENAME"><code class="xref py py-data docutils literal notranslate"><span class="pre">CAPABILITY_QUOTED_FILENAME</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.CAPABILITY_NO_SERVER_SHUTDOWN" title="interbase.services.CAPABILITY_NO_SERVER_SHUTDOWN"><code class="xref py py-data docutils literal notranslate"><span class="pre">CAPABILITY_NO_SERVER_SHUTDOWN</span></code></a></p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_server_capabilities</span><span class="p">()</span>
<span class="go">(2L, 4L, 512L, 256L)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interbase</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">CAPABILITY_MULTI_CLIENT</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">get_server_capabilities</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interbase</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">CAPABILITY_QUOTED_FILENAME</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">get_server_capabilities</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_message_file_directory" title="interbase.services.Connection.get_message_file_directory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_message_file_directory()</span></code></a></p>
<blockquote>
<div><p>To support internationalized error messages/prompts, the database engine stores its messages in a file
named <code class="file docutils literal notranslate"><span class="pre">interbase.msg</span></code>. The directory in which this file resides can be determined with this method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_message_file_directory</span><span class="p">()</span>
<span class="go">/opt/interbase/</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_connection_count" title="interbase.services.Connection.get_connection_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_connection_count()</span></code></a></p>
<blockquote>
<div><p>Returns the number of active connections to databases managed by the server. This count only includes
database connections (such as open instances of <a class="reference internal" href="reference.html#interbase.Connection" title="interbase.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">interbase.Connection</span></code></a>), not services manager connections
(such as open instances of <a class="reference internal" href="reference.html#interbase.services.Connection" title="interbase.services.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">interbase.services.Connection</span></code></a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db1</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db2</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_connection_count</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_attached_database_names" title="interbase.services.Connection.get_attached_database_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_attached_database_names()</span></code></a></p>
<blockquote>
<div><p>Returns a list of the names of all databases to which the server is maintaining at least one connection.
The database names are not guaranteed to be in any particular order.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db1</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db2</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">con</span><span class="o">.</span><span class="n">get_attached_database_names</span><span class="p">()</span>
<span class="go">[&#39;/opt/interbase/examples/empbuild/employee.interbase&#39;]</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_log" title="interbase.services.Connection.get_log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_log()</span></code></a></p>
<blockquote>
<div><p>Request the contents of the server’s log file (<code class="file docutils literal notranslate"><span class="pre">interbase.log</span></code>).</p>
<p>This method is so-called <cite>Async method</cite> that only initiates log transfer. Actual log content could be
read by one from many methods for <a class="reference internal" href="#text-ouput-from-services">text ouput from Services</a> that <cite>Connection</cite> provides .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">get_log</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="database-options">
<h3>Database options<a class="headerlink" href="#database-options" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.set_default_page_buffers" title="interbase.services.Connection.set_default_page_buffers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_default_page_buffers()</span></code></a></p>
<blockquote>
<div><p>Sets individual page cache size for Database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">set_default_page_buffers</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.set_sweep_interval" title="interbase.services.Connection.set_sweep_interval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_sweep_interval()</span></code></a></p>
<blockquote>
<div><p>Sets threshold for automatic sweep.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">set_sweep_interval</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="mi">100000</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.set_reserve_page_space" title="interbase.services.Connection.set_reserve_page_space"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_reserve_page_space()</span></code></a></p>
<blockquote>
<div><p>Sets data page space reservation policy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="go"># Use all space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">set_reserve_page_space</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.set_write_mode" title="interbase.services.Connection.set_write_mode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_write_mode()</span></code></a></p>
<blockquote>
<div><p>Sets Disk Write Mode: Sync (forced writes) or Async (buffered). Following constants are defined
in <a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interbase.services</span></code></a> for convenience:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.services.WRITE_FORCED" title="interbase.services.WRITE_FORCED"><code class="xref py py-data docutils literal notranslate"><span class="pre">WRITE_FORCED</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.WRITE_BUFFERED" title="interbase.services.WRITE_BUFFERED"><code class="xref py py-data docutils literal notranslate"><span class="pre">WRITE_BUFFERED</span></code></a></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="go"># Disable Forced Writes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">set_write_mode</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">services</span><span class="o">.</span><span class="n">WRITE_BUFFERED</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.set_access_mode" title="interbase.services.Connection.set_access_mode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_access_mode()</span></code></a></p>
<blockquote>
<div><p>Sets Database Access mode: Read Only or Read/Write. Following constants are defined
in <a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interbase.services</span></code></a> for convenience:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.services.ACCESS_READ_WRITE" title="interbase.services.ACCESS_READ_WRITE"><code class="xref py py-data docutils literal notranslate"><span class="pre">ACCESS_READ_WRITE</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.ACCESS_READ_ONLY" title="interbase.services.ACCESS_READ_ONLY"><code class="xref py py-data docutils literal notranslate"><span class="pre">ACCESS_READ_ONLY</span></code></a></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="go"># Set database to R/O mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">set_access_mode</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">services</span><span class="o">.</span><span class="n">ACCESS_READ_ONLY</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.set_sql_dialect" title="interbase.services.Connection.set_sql_dialect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_sql_dialect()</span></code></a></p>
<blockquote>
<div><p>Sets SQL Dialect for Database.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Changing SQL dialect on existing database is not recommended. Only newly created database
objects would respect new dialect setting, while objects created with previous dialect remain
unchanged. That may have dire consequences.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="go"># Use SQL dialect 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">set_sql_dialect</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="database-maintenance">
<h3>Database maintenance<a class="headerlink" href="#database-maintenance" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_limbo_transaction_ids" title="interbase.services.Connection.get_limbo_transaction_ids"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_limbo_transaction_ids()</span></code></a></p>
<blockquote>
<div><p>Returns list of transactions in limbo.</p>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.commit_limbo_transaction" title="interbase.services.Connection.commit_limbo_transaction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">commit_limbo_transaction()</span></code></a></p>
<blockquote>
<div><p>Resolves limbo transaction with commit.</p>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.rollback_limbo_transaction" title="interbase.services.Connection.rollback_limbo_transaction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rollback_limbo_transaction()</span></code></a></p>
<blockquote>
<div><p>Resolves limbo transaction with rollback.</p>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_statistics" title="interbase.services.Connection.get_statistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_statistics()</span></code></a></p>
<blockquote>
<div><p>Request database statistics. Report is in the same format as the output of the gstat command-line
utility. This method has one required parameter, the location of the database on which to compute
statistics, and six optional boolean parameters for controlling the domain of the statistics.</p>
<p>This method is so-called <cite>Async method</cite> that only initiates report processing. Actual report could be
read by one from many methods for <a class="reference internal" href="#text-ouput-from-services">text ouput from Services</a> that <cite>Connection</cite> provides .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Until statistical report is not fully fetched from service (or ignored via
<a class="reference internal" href="reference.html#interbase.services.Connection.wait" title="interbase.services.Connection.wait"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait()</span></code></a>), any attempt to start another asynchronous service will
fail with exception.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stat_report</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.backup" title="interbase.services.Connection.backup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backup()</span></code></a></p>
<blockquote>
<div><p>Request logical (GBAK) database backup. Produces report about backup process.</p>
<p>This method is so-called <cite>Async method</cite> that only initiates backup process. Actual report could be
read by one from many methods for <a class="reference internal" href="#text-ouput-from-services">text ouput from Services</a> that <cite>Connection</cite> provides .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Until backup report is not fully fetched from service (or ignored via
<a class="reference internal" href="reference.html#interbase.services.Connection.wait" title="interbase.services.Connection.wait"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait()</span></code></a>), any attempt to start another asynchronous service will
fail with exception.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/data/employee.ibk&#39;</span><span class="p">,</span> <span class="n">metadata_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">collect_garbage</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">backup_report</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.restore" title="interbase.services.Connection.restore"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restore()</span></code></a></p>
<blockquote>
<div><p>Request database restore from logical (GBAK) backup. Produces report about restore process.</p>
<p>This method is so-called <cite>Async method</cite> that only initiates restore process. Actual report could be
read by one from many methods for <a class="reference internal" href="#text-ouput-from-services">text ouput from Services</a> that <cite>Connection</cite> provides .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Until restore report is not fully fetched from service (or ignored via
<a class="reference internal" href="reference.html#interbase.services.Connection.wait" title="interbase.services.Connection.wait"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait()</span></code></a>), any attempt to start another asynchronous service will
fail with exception.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="s1">&#39;/home/data/employee.ibk&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/data/empcopy.interbase&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">restore_report</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.bring_online" title="interbase.services.Connection.bring_online"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bring_online()</span></code></a></p>
<blockquote>
<div><p>Bring previously shut down database back online. Following constants are defined in
<a class="reference internal" href="reference.html#module-interbase.services" title="interbase.services: Submodule for work with InterBase Services"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interbase.services</span></code></a> for convenience:</p>
<p>For on-line mode:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.services.SHUT_NORMAL" title="interbase.services.SHUT_NORMAL"><code class="xref py py-data docutils literal notranslate"><span class="pre">SHUT_NORMAL</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.SHUT_SINGLE" title="interbase.services.SHUT_SINGLE"><code class="xref py py-data docutils literal notranslate"><span class="pre">SHUT_SINGLE</span></code></a></p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.SHUT_MULTI" title="interbase.services.SHUT_MULTI"><code class="xref py py-data docutils literal notranslate"><span class="pre">SHUT_MULTI</span></code></a></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="go"># Enable multi-user maintenance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">bring_online</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="n">services</span><span class="o">.</span><span class="n">SHUT_MULTI</span><span class="p">)</span>
<span class="go"># Enable single-user maintenance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">bring_online</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="n">services</span><span class="o">.</span><span class="n">SHUT_SINGLE</span><span class="p">)</span>
<span class="go"># Return to normal state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">bring_online</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.activate_shadow" title="interbase.services.Connection.activate_shadow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">activate_shadow()</span></code></a></p>
<blockquote>
<div><p>Activates Database Shadow(s).</p>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.sweep" title="interbase.services.Connection.sweep"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sweep()</span></code></a></p>
<blockquote>
<div><p>Performs Database Sweep.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method call will not return until sweep is finished.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">sweep</span><span class="p">(</span><span class="s1">&#39;empoyee&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.repair" title="interbase.services.Connection.repair"><code class="xref py py-meth docutils literal notranslate"><span class="pre">repair()</span></code></a></p>
<blockquote>
<div><p>Database Validation and Repair.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Method call will not return until action is finished.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="go"># Just validate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">repair</span><span class="p">(</span><span class="s1">&#39;empoyee&#39;</span><span class="p">,</span> <span class="n">ignore_checksums</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">read_only_validation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go"># Mend the database</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">repair</span><span class="p">(</span><span class="s1">&#39;empoyee&#39;</span><span class="p">,</span> <span class="n">ignore_checksums</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mend_database</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="user-maintenance">
<h3>User maintenance<a class="headerlink" href="#user-maintenance" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.get_users" title="interbase.services.Connection.get_users"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_users()</span></code></a></p>
<blockquote>
<div><p>Returns information about specified user or all users as a list of <a class="reference internal" href="reference.html#interbase.services.User" title="interbase.services.User"><code class="xref py py-class docutils literal notranslate"><span class="pre">User</span></code></a> instances.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">users</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">get_users</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">user</span><span class="o">.</span><span class="n">first_name</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">middle_name</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">last_name</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">user</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">group_id</span>
<span class="go">SYSDBA</span>
<span class="go">Sql Server Administrator</span>
<span class="go">0 0</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.add_user" title="interbase.services.Connection.add_user"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_user()</span></code></a></p>
<blockquote>
<div><p>Adds new user. Requires instance of <a class="reference internal" href="reference.html#interbase.services.User" title="interbase.services.User"><code class="xref py py-class docutils literal notranslate"><span class="pre">User</span></code></a> with <strong>at least</strong> its <a class="reference internal" href="reference.html#interbase.services.User.name" title="interbase.services.User.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a>
and <a class="reference internal" href="reference.html#interbase.services.User.password" title="interbase.services.User.password"><code class="xref py py-attr docutils literal notranslate"><span class="pre">password</span></code></a> attributes specified as non-empty values. All other attributes
are optional.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">User</span><span class="p">(</span><span class="s1">&#39;NewUser&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;secret&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="s1">&#39;John&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">last_name</span> <span class="o">=</span> <span class="s1">&#39;Doe&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">add_users</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.modify_user" title="interbase.services.Connection.modify_user"><code class="xref py py-meth docutils literal notranslate"><span class="pre">modify_user()</span></code></a></p>
<blockquote>
<div><p>Modification of user information. Requires instance of <a class="reference internal" href="reference.html#interbase.services.User" title="interbase.services.User"><code class="xref py py-class docutils literal notranslate"><span class="pre">User</span></code></a> with <strong>at least</strong> its
<a class="reference internal" href="reference.html#interbase.services.User.name" title="interbase.services.User.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a> attribute specified as non-empty value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sets <a class="reference internal" href="reference.html#interbase.services.User.first_name" title="interbase.services.User.first_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">first_name</span></code></a>, <a class="reference internal" href="reference.html#interbase.services.User.middle_name" title="interbase.services.User.middle_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">middle_name</span></code></a> and <a class="reference internal" href="reference.html#interbase.services.User.last_name" title="interbase.services.User.last_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">last_name</span></code></a> to
their actual values, and ignores the <a class="reference internal" href="reference.html#interbase.services.User.user_id" title="interbase.services.User.user_id"><code class="xref py py-attr docutils literal notranslate"><span class="pre">user_id</span></code></a> and <a class="reference internal" href="reference.html#interbase.services.User.group_id" title="interbase.services.User.group_id"><code class="xref py py-attr docutils literal notranslate"><span class="pre">group_id</span></code></a> attributes
regardless of their values. <a class="reference internal" href="reference.html#interbase.services.User.password" title="interbase.services.User.password"><code class="xref py py-attr docutils literal notranslate"><span class="pre">password</span></code></a> is set <strong>only</strong> when it has value.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">User</span><span class="p">(</span><span class="s1">&#39;SYSDBA&#39;</span><span class="p">)</span>
<span class="go"># Change pasword</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;Pa$$w0rd&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">modify_user</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.remove_user" title="interbase.services.Connection.remove_user"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_user()</span></code></a></p>
<blockquote>
<div><p>Removes user. Requires User name or instance of <a class="reference internal" href="reference.html#interbase.services.User" title="interbase.services.User"><code class="xref py py-class docutils literal notranslate"><span class="pre">User</span></code></a> with <strong>at least</strong> its
<a class="reference internal" href="reference.html#interbase.services.User.name" title="interbase.services.User.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a> attribute specified as non-empty value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">remove_user</span><span class="p">(</span><span class="s1">&#39;NewUser&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="reference.html#interbase.services.Connection.user_exists" title="interbase.services.Connection.user_exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">user_exists()</span></code></a></p>
<blockquote>
<div><p>Checks for user’s existence. Requires User name or instance of <a class="reference internal" href="reference.html#interbase.services.User" title="interbase.services.User"><code class="xref py py-class docutils literal notranslate"><span class="pre">User</span></code></a> with <strong>at least</strong> its
<a class="reference internal" href="reference.html#interbase.services.User.name" title="interbase.services.User.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a> attribute specified as non-empty value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">interbase</span> <span class="kn">import</span> <span class="n">services</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">user_exists</span><span class="p">(</span><span class="s1">&#39;NewUser&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="text-ouput-from-services">
<h3>Text ouput from Services<a class="headerlink" href="#text-ouput-from-services" title="Permalink to this heading">¶</a></h3>
<p>Some services like <cite>backup</cite> or <cite>trace</cite> may return significant amount of text. Rather than return the whole
text as single string value by methods that provide access to these services, Interbase isolated the transfer
process to separate methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.services.Connection.readline" title="interbase.services.Connection.readline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">readline()</span></code></a> - Similar to <code class="xref py py-meth docutils literal notranslate"><span class="pre">file.readline()</span></code>, returns next line of output from Service.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.Connection.readlines" title="interbase.services.Connection.readlines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">readlines()</span></code></a> - Like <code class="xref py py-meth docutils literal notranslate"><span class="pre">file.readlines()</span></code>, returns list of output lines.</p></li>
<li><p>Iteration over <cite>Connection</cite> object, because <a class="reference internal" href="reference.html#interbase.services.Connection" title="interbase.services.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> has built-in support for <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator
protocol</span></a>.</p></li>
<li><p>Using <cite>callback</cite> method provided by developer. Each <cite>Connection</cite> method that returns its result
asynchronously accepts an optional parameter <cite>callback</cite>, which must be a function that accepts one string
parameter. This method is then called with each output line coming from service.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.services.Connection.wait" title="interbase.services.Connection.wait"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait()</span></code></a> - Waits for Service to finish, ignoring rest of the output it may produce.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Until output is not fully fetched from service, any attempt to start another asynchronous service will
fail with exception! This constraint is set by InterBase Service API.</p>
<p>You may check the status of asynchronous Services using <a class="reference internal" href="reference.html#interbase.services.Connection.fetching" title="interbase.services.Connection.fetching"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.fetching</span></code></a> attribute or
<a class="reference internal" href="reference.html#interbase.services.Connection.isrunning" title="interbase.services.Connection.isrunning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.isrunning()</span></code></a> method.</p>
<p>In cases when you’re not interested in output produced by Service, call <a class="reference internal" href="reference.html#interbase.services.Connection.wait" title="interbase.services.Connection.wait"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait()</span></code></a> to
wait for service to complete.</p>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="n">svc</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="s2">&quot;Fetch materialized&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;==================&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;Start backup&quot;</span>
<span class="n">svc</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="s1">&#39;employee.ibk&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;svc.fetching is&quot;</span><span class="p">,</span> <span class="n">svc</span><span class="o">.</span><span class="n">fetching</span>
<span class="nb">print</span> <span class="s2">&quot;svc.running is&quot;</span><span class="p">,</span> <span class="n">svc</span><span class="o">.</span><span class="n">isrunning</span><span class="p">()</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="nb">print</span> <span class="s2">&quot;</span><span class="si">%i</span><span class="s2"> lines returned&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;First 5 lines from output:&quot;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
   <span class="nb">print</span> <span class="n">i</span><span class="p">,</span><span class="n">report</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="nb">print</span> <span class="s2">&quot;svc.fetching is&quot;</span><span class="p">,</span> <span class="n">svc</span><span class="o">.</span><span class="n">fetching</span>
<span class="nb">print</span> <span class="s2">&quot;svc.running is&quot;</span><span class="p">,</span> <span class="n">svc</span><span class="o">.</span><span class="n">isrunning</span><span class="p">()</span>
<span class="nb">print</span>
<span class="nb">print</span> <span class="s2">&quot;Iterate over result&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;===================&quot;</span>
<span class="n">svc</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="s1">&#39;employee.ibk&#39;</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">svc</span><span class="p">:</span>
   <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;</span><span class="si">%i</span><span class="s2"> lines returned&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Last 5 lines from output:&quot;</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]:</span>
   <span class="nb">print</span> <span class="n">line</span>
<span class="nb">print</span>
<span class="nb">print</span> <span class="s2">&quot;Callback&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;========&quot;</span>

<span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Callback function</span>
<span class="k">def</span> <span class="nf">fetchline</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
   <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">svc</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span> <span class="s1">&#39;employee.ibk&#39;</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">fetchline</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;</span><span class="si">%i</span><span class="s2"> lines returned&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Last 5 lines from output:&quot;</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]:</span>
   <span class="nb">print</span> <span class="n">line</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fetch</span> <span class="n">materialized</span>
<span class="o">==================</span>
<span class="n">Start</span> <span class="n">backup</span>
<span class="n">svc</span><span class="o">.</span><span class="n">fetching</span> <span class="ow">is</span> <span class="kc">True</span>
<span class="n">svc</span><span class="o">.</span><span class="n">running</span> <span class="ow">is</span> <span class="kc">True</span>
<span class="mi">558</span> <span class="n">lines</span> <span class="n">returned</span>
<span class="n">First</span> <span class="mi">5</span> <span class="n">lines</span> <span class="kn">from</span> <span class="nn">output</span><span class="p">:</span>
<span class="mi">0</span> <span class="n">gbak</span><span class="p">:</span><span class="n">readied</span> <span class="n">database</span> <span class="n">employee</span> <span class="k">for</span> <span class="n">backup</span>
<span class="mi">1</span> <span class="n">gbak</span><span class="p">:</span><span class="n">creating</span> <span class="n">file</span> <span class="n">employee</span><span class="o">.</span><span class="n">ibk</span>
<span class="mi">2</span> <span class="n">gbak</span><span class="p">:</span><span class="n">starting</span> <span class="n">transaction</span>
<span class="mi">3</span> <span class="n">gbak</span><span class="p">:</span><span class="n">database</span> <span class="n">employee</span> <span class="n">has</span> <span class="n">a</span> <span class="n">page</span> <span class="n">size</span> <span class="n">of</span> <span class="mi">4096</span> <span class="nb">bytes</span><span class="o">.</span>
<span class="mi">4</span> <span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">domains</span>
<span class="n">svc</span><span class="o">.</span><span class="n">fetching</span> <span class="ow">is</span> <span class="kc">False</span>
<span class="n">svc</span><span class="o">.</span><span class="n">running</span> <span class="ow">is</span> <span class="kc">False</span>

<span class="n">Iterate</span> <span class="n">over</span> <span class="n">result</span>
<span class="o">===================</span>
<span class="mi">558</span> <span class="n">lines</span> <span class="n">returned</span>
<span class="n">Last</span> <span class="mi">5</span> <span class="n">lines</span> <span class="kn">from</span> <span class="nn">output</span><span class="p">:</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">referential</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">check</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">SQL</span> <span class="n">roles</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">names</span> <span class="n">mapping</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">closing</span> <span class="n">file</span><span class="p">,</span> <span class="n">committing</span><span class="p">,</span> <span class="ow">and</span> <span class="n">finishing</span><span class="o">.</span> <span class="mi">74752</span> <span class="nb">bytes</span> <span class="n">written</span>

<span class="n">Callback</span>
<span class="o">========</span>
<span class="mi">558</span> <span class="n">lines</span> <span class="n">returned</span>
<span class="n">Last</span> <span class="mi">5</span> <span class="n">lines</span> <span class="kn">from</span> <span class="nn">output</span><span class="p">:</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">referential</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">check</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">SQL</span> <span class="n">roles</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">names</span> <span class="n">mapping</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">closing</span> <span class="n">file</span><span class="p">,</span> <span class="n">committing</span><span class="p">,</span> <span class="ow">and</span> <span class="n">finishing</span><span class="o">.</span> <span class="mi">74752</span> <span class="nb">bytes</span> <span class="n">written</span>
</pre></div>
</div>
</section>
</section>
<section id="working-with-database-schema">
<span id="working-with-schema"></span><span id="index-30"></span><h2>Working with database schema<a class="headerlink" href="#working-with-database-schema" title="Permalink to this heading">¶</a></h2>
<p>Description of database objects like tables, views, stored procedures, triggers or UDF functions that
represent database schema is stored in set of system tables present in every database. InterBase users
can query these tables to get information about these objects and their relations. But querying system
tables is inconvenient, as it requires good knowledge how this information is structured and requires
significant amount of Python code. Changes in system tables between InterBase versions further add to this
complexity. Hence Interbase provides set of classes (isolated in separate module <a class="reference internal" href="reference.html#module-interbase.schema" title="interbase.schema: Submodule for work with database metadata (schema)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interbase.schema</span></code></a>) that
transform information stored in system tables into set of Python objects that surface the vital information
in meaningful way, and additionally provide set of methods for most commonly used operations or checks.</p>
<p>Database schema could be accessed in three different ways, each suitable for different use case:</p>
<ul class="simple">
<li><p>By direct creation of <a class="reference internal" href="reference.html#interbase.schema.Schema" title="interbase.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">interbase.schema.Schema</span></code></a> instances that are then <a class="reference internal" href="reference.html#interbase.schema.Schema.bind" title="interbase.schema.Schema.bind"><code class="xref py py-meth docutils literal notranslate"><span class="pre">binded</span></code></a>
to particular <a class="reference internal" href="reference.html#interbase.services.Connection" title="interbase.services.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> instance. This method is best if you want to work with schema only
occasionally, or you want to keep connections as lightweight as possible.</p></li>
<li><p>Accessing <a class="reference internal" href="reference.html#interbase.Connection.schema" title="interbase.Connection.schema"><code class="xref py py-attr docutils literal notranslate"><span class="pre">interbase.Connection.schema</span></code></a> property. This method is more convenient than previous one, and
represents a compromise between convenience and resource consumption because <code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code> instance is not created until first reference and is managed by connection itself. Individual metadata
objects are not loaded from system tables until first reference.</p></li>
<li><p>Using <a class="reference internal" href="reference.html#interbase.ConnectionWithSchema" title="interbase.ConnectionWithSchema"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionWithSchema</span></code></a> instead <a class="reference internal" href="reference.html#interbase.services.Connection" title="interbase.services.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> by specifying
<cite>connection_class=ConnectionWithSchema</cite> parameter to <a class="reference internal" href="reference.html#interbase.connect" title="interbase.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> or <a class="reference internal" href="reference.html#interbase.create_database" title="interbase.create_database"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_database()</span></code></a>.
This <cite>Connection</cite> descendant loads all database metadata immediately and provides directly all attributes
and methods provided by <a class="reference internal" href="reference.html#interbase.schema.Schema" title="interbase.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> class. This method is most suitable in case you want
to work with database metadata extensively.</p></li>
</ul>
<p><strong>Examples:</strong></p>
<ol class="arabic simple">
<li><p>Using Schema instance:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">Schema</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">tables</span><span class="p">]</span>
<span class="go">[&#39;COUNTRY&#39;, &#39;JOB&#39;, &#39;DEPARTMENT&#39;, &#39;EMPLOYEE&#39;, &#39;SALES&#39;, &#39;PROJECT&#39;, &#39;EMPLOYEE_PROJECT&#39;, &#39;PROJ_DEPT_BUDGET&#39;,</span>
<span class="go"> &#39;SALARY_HISTORY&#39;, &#39;CUSTOMER&#39;]</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Using Connection.schema:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">tables</span><span class="p">]</span>
<span class="go">[&#39;COUNTRY&#39;, &#39;JOB&#39;, &#39;DEPARTMENT&#39;, &#39;EMPLOYEE&#39;, &#39;SALES&#39;, &#39;PROJECT&#39;, &#39;EMPLOYEE_PROJECT&#39;, &#39;PROJ_DEPT_BUDGET&#39;,</span>
<span class="go"> &#39;SALARY_HISTORY&#39;, &#39;CUSTOMER&#39;]</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Using ConnectionWithSchema:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">,</span>
<span class="go">    connection_class=interbase.ConnectionWithSchema)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">tables</span><span class="p">]</span>
<span class="go">[&#39;COUNTRY&#39;, &#39;JOB&#39;, &#39;DEPARTMENT&#39;, &#39;EMPLOYEE&#39;, &#39;SALES&#39;, &#39;PROJECT&#39;, &#39;EMPLOYEE_PROJECT&#39;, &#39;PROJ_DEPT_BUDGET&#39;,</span>
<span class="go"> &#39;SALARY_HISTORY&#39;, &#39;CUSTOMER&#39;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Individual metadata information (i.e. information about <a class="reference internal" href="reference.html#interbase.schema.Schema.domains" title="interbase.schema.Schema.domains"><code class="xref py py-attr docutils literal notranslate"><span class="pre">domains</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Schema.tables" title="interbase.schema.Schema.tables"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tables</span></code></a> etc.) is loaded on first access and cached for further reference until it’s <a class="reference internal" href="reference.html#interbase.schema.Schema.clear" title="interbase.schema.Schema.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cleared</span></code></a> or <a class="reference internal" href="reference.html#interbase.schema.Schema.reload" title="interbase.schema.Schema.reload"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reload</span></code></a> is
requested.</p>
<p>Because once loaded information is cached, it’s good to <a class="reference internal" href="reference.html#interbase.schema.Schema.clear" title="interbase.schema.Schema.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clear</span></code></a> it
when it’s no longer needed to conserve memory.</p>
</div>
<section id="available-information">
<h3>Available information<a class="headerlink" href="#available-information" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="reference.html#interbase.schema.Schema" title="interbase.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> provides information about:</p>
<ul class="simple">
<li><p><strong>Database:</strong> <a class="reference internal" href="reference.html#interbase.schema.Schema.owner_name" title="interbase.schema.Schema.owner_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Owner</span> <span class="pre">name</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.default_character_set" title="interbase.schema.Schema.default_character_set"><code class="xref py py-attr docutils literal notranslate"><span class="pre">default</span> <span class="pre">character</span> <span class="pre">set</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.description" title="interbase.schema.Schema.description"><code class="xref py py-attr docutils literal notranslate"><span class="pre">description</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.security_class" title="interbase.schema.Schema.security_class"><code class="xref py py-attr docutils literal notranslate"><span class="pre">security</span> <span class="pre">class</span></code></a> and whether database consist
from <a class="reference internal" href="reference.html#interbase.schema.Schema.ismultifile" title="interbase.schema.Schema.ismultifile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">single</span> <span class="pre">or</span> <span class="pre">multiple</span> <span class="pre">files</span></code></a>.</p></li>
<li><p><strong>Facilities:</strong> Available <a class="reference internal" href="reference.html#interbase.schema.Schema.character_sets" title="interbase.schema.Schema.character_sets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">character</span> <span class="pre">sets</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.collations" title="interbase.schema.Schema.collations"><code class="xref py py-attr docutils literal notranslate"><span class="pre">collations</span></code></a>, database <a class="reference internal" href="reference.html#interbase.schema.Schema.files" title="interbase.schema.Schema.files"><code class="xref py py-attr docutils literal notranslate"><span class="pre">files</span></code></a> and
<a class="reference internal" href="reference.html#interbase.schema.Schema.shadows" title="interbase.schema.Schema.shadows"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shadows</span></code></a>.</p></li>
<li><p><strong>User database objects:</strong> <a class="reference internal" href="reference.html#interbase.schema.Schema.exceptions" title="interbase.schema.Schema.exceptions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">exceptions</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.generators" title="interbase.schema.Schema.generators"><code class="xref py py-attr docutils literal notranslate"><span class="pre">generators</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Schema.domains" title="interbase.schema.Schema.domains"><code class="xref py py-attr docutils literal notranslate"><span class="pre">domains</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.tables" title="interbase.schema.Schema.tables"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tables</span></code></a> and their <a class="reference internal" href="reference.html#interbase.schema.Schema.constraints" title="interbase.schema.Schema.constraints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">constraints</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.indices" title="interbase.schema.Schema.indices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">indices</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Schema.views" title="interbase.schema.Schema.views"><code class="xref py py-attr docutils literal notranslate"><span class="pre">views</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.triggers" title="interbase.schema.Schema.triggers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">triggers</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Schema.procedures" title="interbase.schema.Schema.procedures"><code class="xref py py-attr docutils literal notranslate"><span class="pre">procedures</span></code></a>,
user <a class="reference internal" href="reference.html#interbase.schema.Schema.roles" title="interbase.schema.Schema.roles"><code class="xref py py-attr docutils literal notranslate"><span class="pre">roles</span></code></a> and <a class="reference internal" href="reference.html#interbase.schema.Schema.functions" title="interbase.schema.Schema.functions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">user</span> <span class="pre">defined</span> <span class="pre">functions</span></code></a>.</p></li>
<li><p><strong>System database objects:</strong> <a class="reference internal" href="reference.html#interbase.schema.Schema.sysgenerators" title="interbase.schema.Schema.sysgenerators"><code class="xref py py-attr docutils literal notranslate"><span class="pre">generators</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.sysdomains" title="interbase.schema.Schema.sysdomains"><code class="xref py py-attr docutils literal notranslate"><span class="pre">domains</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Schema.systables" title="interbase.schema.Schema.systables"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tables</span></code></a> and their
constraints,  <a class="reference internal" href="reference.html#interbase.schema.Schema.sysindices" title="interbase.schema.Schema.sysindices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">indices</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Schema.sysviews" title="interbase.schema.Schema.sysviews"><code class="xref py py-attr docutils literal notranslate"><span class="pre">views</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Schema.systriggers" title="interbase.schema.Schema.systriggers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">triggers</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Schema.sysprocedures" title="interbase.schema.Schema.sysprocedures"><code class="xref py py-attr docutils literal notranslate"><span class="pre">procedures</span></code></a>
and <a class="reference internal" href="reference.html#interbase.schema.Schema.sysfunctions" title="interbase.schema.Schema.sysfunctions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">functions</span></code></a>.</p></li>
<li><p><strong>Relations between objects:</strong> Through direct links between metadata objects and
<a class="reference internal" href="reference.html#interbase.schema.Schema.dependencies" title="interbase.schema.Schema.dependencies"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dependencies</span></code></a>.</p></li>
<li><p><strong>Privileges:</strong> <a class="reference internal" href="reference.html#interbase.schema.Schema.privileges" title="interbase.schema.Schema.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">All</span></code></a> privileges, or privileges granted for specific
<a class="reference internal" href="reference.html#interbase.schema.Table.privileges" title="interbase.schema.Table.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.TableColumn.privileges" title="interbase.schema.TableColumn.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span> <span class="pre">column</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.View.privileges" title="interbase.schema.View.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">view</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.ViewColumn.privileges" title="interbase.schema.ViewColumn.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">view</span> <span class="pre">column</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Procedure.privileges" title="interbase.schema.Procedure.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">procedure</span></code></a> or <a class="reference internal" href="reference.html#interbase.schema.Role.privileges" title="interbase.schema.Role.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">role</span></code></a>. It’s also
possible to get all privileges <a class="reference internal" href="reference.html#interbase.schema.Schema.get_privileges_of" title="interbase.schema.Schema.get_privileges_of"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granted</span> <span class="pre">to</span></code></a> specific user, role,
procedure, trigger or view.</p></li>
</ul>
</section>
<section id="metadata-objects">
<h3>Metadata objects<a class="headerlink" href="#metadata-objects" title="Permalink to this heading">¶</a></h3>
<p>Schema information is presented as Python objects of various classes with common parent class
<a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem" title="interbase.schema.BaseSchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSchemaItem</span></code></a> (except <a class="reference internal" href="reference.html#interbase.schema.Schema" title="interbase.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> itself), that defines several
common attributes and methods:</p>
<p>Attributes:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.name" title="interbase.schema.BaseSchemaItem.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a>: Name of database object or None if object doesn’t have a name.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.description" title="interbase.schema.BaseSchemaItem.description"><code class="xref py py-attr docutils literal notranslate"><span class="pre">description</span></code></a>: Description (documentation text) for object or None if
object doesn’t have a description.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.actions" title="interbase.schema.BaseSchemaItem.actions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">actions</span></code></a>: List of supported SQL operations on schema object instance.</p></li>
</ul>
<p>Methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.accept_visitor" title="interbase.schema.BaseSchemaItem.accept_visitor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">accept_visitor()</span></code></a>: <a class="reference internal" href="#visitor-pattern-support"><span class="std std-ref">Visitor Pattern support</span></a>.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.issystemobject" title="interbase.schema.BaseSchemaItem.issystemobject"><code class="xref py py-meth docutils literal notranslate"><span class="pre">issystemobject()</span></code></a>: Returns True if this database object is system object.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.get_quoted_name" title="interbase.schema.BaseSchemaItem.get_quoted_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_quoted_name()</span></code></a>: Returns quoted (if necessary) name of database object.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.get_dependents" title="interbase.schema.BaseSchemaItem.get_dependents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_dependents()</span></code></a>: Returns list of all database objects that
<a class="reference internal" href="#object-dependencies"><span class="std std-ref">depend</span></a> on this one.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.get_dependencies" title="interbase.schema.BaseSchemaItem.get_dependencies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_dependencies()</span></code></a>: Returns list of database objects that this object
<a class="reference internal" href="#object-dependencies"><span class="std std-ref">depend</span></a> on.</p></li>
<li><p><a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.get_sql_for" title="interbase.schema.BaseSchemaItem.get_sql_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sql_for()</span></code></a>: Returns <a class="reference internal" href="#sql-oprations"><span class="std std-ref">SQL command string</span></a> for
specified action on database object.</p></li>
</ul>
<p>There are next schema objects: <a class="reference internal" href="reference.html#interbase.schema.Collation" title="interbase.schema.Collation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collation</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.CharacterSet" title="interbase.schema.CharacterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">CharacterSet</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.DatabaseException" title="interbase.schema.DatabaseException"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseException</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Domain" title="interbase.schema.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Domain</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Index" title="interbase.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Table" title="interbase.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.TableColumn" title="interbase.schema.TableColumn"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableColumn</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Constraint" title="interbase.schema.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.View" title="interbase.schema.View"><code class="xref py py-class docutils literal notranslate"><span class="pre">View</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.ViewColumn" title="interbase.schema.ViewColumn"><code class="xref py py-class docutils literal notranslate"><span class="pre">ViewColumn</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Trigger" title="interbase.schema.Trigger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trigger</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Procedure" title="interbase.schema.Procedure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Procedure</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.ProcedureParameter" title="interbase.schema.ProcedureParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProcedureParameter</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Function" title="interbase.schema.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.FunctionArgument" title="interbase.schema.FunctionArgument"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionArgument</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.Role" title="interbase.schema.Role"><code class="xref py py-class docutils literal notranslate"><span class="pre">Role</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Dependency" title="interbase.schema.Dependency"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.DatabaseFile" title="interbase.schema.DatabaseFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseFile</span></code></a> and <a class="reference internal" href="reference.html#interbase.schema.Shadow" title="interbase.schema.Shadow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shadow</span></code></a>.</p>
</section>
<section id="visitor-pattern-support">
<span id="id7"></span><h3>Visitor Pattern support<a class="headerlink" href="#visitor-pattern-support" title="Permalink to this heading">¶</a></h3>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Visitor_pattern">Visitor Pattern</a> is particularly useful when you need to process various objects that need special handling
in common algorithm (for example display information about them or generate SQL commands to create them in new
database). Each metadata object (including <a class="reference internal" href="reference.html#interbase.schema.Schema" title="interbase.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a>) supports
<a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.accept_visitor" title="interbase.schema.BaseSchemaItem.accept_visitor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">accept_visitor()</span></code></a> method that calls <cite>class-specific</cite> method on object passed
to it as parameter. This method name always starts with ‘visit’. For example <a class="reference internal" href="reference.html#interbase.schema.Table" title="interbase.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> object
calls <cite>visitTable</cite>. This ‘visit*’ method has one parameter - object instance that calls it.</p>
<p>Interbase provides skeleton implementation for <a class="reference internal" href="reference.html#interbase.schema.SchemaVisitor" title="interbase.schema.SchemaVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">schema</span> <span class="pre">Visitor</span> <span class="pre">object</span></code></a> that
implements all <cite>visit*</cite> methods called by schema classes as call to method <cite>default_action</cite> that does
nothing.</p>
<p>Next code uses visitor pattern to print all DROP SQL statements necessary to drop database object,
taking its dependencies into account, i.e. it could be necessary to first drop other - dependent objects
before it could be dropped.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="c1"># Object dropper</span>
<span class="k">class</span> <span class="nc">ObjectDropper</span><span class="p">(</span><span class="n">interbase</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">SchemaVisitor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seen</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">accept_visitor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">default_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">issystemobject</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;drop&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
           <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_dependents</span><span class="p">():</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">dependency</span><span class="o">.</span><span class="n">dependent</span>
                <span class="k">if</span> <span class="n">d</span> <span class="ow">and</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seen</span><span class="p">:</span>
                    <span class="n">d</span><span class="o">.</span><span class="n">accept_visitor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
           <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seen</span><span class="p">:</span>
                <span class="nb">print</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seen</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">visitSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">schema</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">visitMetadataItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">visitTableColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">column</span><span class="p">):</span>
        <span class="n">column</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">accept_visitor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">visitViewColumn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">column</span><span class="p">):</span>
        <span class="n">column</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">accept_visitor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">visitDependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dependency</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">visitConstraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">constraint</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">visitProcedureParameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">):</span>
        <span class="n">param</span><span class="o">.</span><span class="n">procedure</span><span class="o">.</span><span class="n">accept_visitor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">visitFunctionArgument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">arg</span><span class="p">):</span>
        <span class="n">arg</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">accept_visitor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">visitDatabaseFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dbfile</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">visitShadow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">shadow</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="c1"># Sample use:</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;JOB&#39;</span><span class="p">)</span>
<span class="n">dropper</span> <span class="o">=</span> <span class="n">ObjectDropper</span><span class="p">()</span>
<span class="n">dropper</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
<p>Will produce next result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DROP</span> <span class="n">PROCEDURE</span> <span class="n">ALL_LANGS</span>
<span class="n">DROP</span> <span class="n">PROCEDURE</span> <span class="n">SHOW_LANGS</span>
<span class="n">DROP</span> <span class="n">TABLE</span> <span class="n">JOB</span>
</pre></div>
</div>
</section>
<section id="object-dependencies">
<span id="id8"></span><h3>Object dependencies<a class="headerlink" href="#object-dependencies" title="Permalink to this heading">¶</a></h3>
<p>Close relations between metadata object like <cite>ownership</cite> (Table vs. TableColumn, Index or Trigger) or
<cite>cooperation</cite> (like FK Index vs. partner UQ/PK Index) are defined directly using properties of particular
schema objects. Besides close relations InterBase also uses <cite>dependencies</cite>, that describe functional
dependency between otherwise independent metadata objects. For example stored procedure can call other stored
procedures, define its parameters using domains or work with tables or views. Removing or changing these
objects may/will cause the procedure to stop working correctly, so InterBase tracks these dependencies.
Interbase surfaces these dependencies as <a class="reference internal" href="reference.html#interbase.schema.Dependency" title="interbase.schema.Dependency"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code></a> schema objects, and all schema objects
have <a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.get_dependents" title="interbase.schema.BaseSchemaItem.get_dependents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_dependents()</span></code></a> and <a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.get_dependencies" title="interbase.schema.BaseSchemaItem.get_dependencies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_dependencies()</span></code></a>
methods to get list of <a class="reference internal" href="reference.html#interbase.schema.Dependency" title="interbase.schema.Dependency"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code></a> instances that describe these dependencies.</p>
<p><a class="reference internal" href="reference.html#interbase.schema.Dependency" title="interbase.schema.Dependency"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dependency</span></code></a> object provides names and types of dependent/depended on database objects,
and access to their respective schema Python objects as well.</p>
</section>
<section id="sql-operations">
<span id="sql-oprations"></span><h3>SQL operations<a class="headerlink" href="#sql-operations" title="Permalink to this heading">¶</a></h3>
<p>Interbase doesn’t allow you to change database metadata directly using schema objects. Instead it supports
generation of DDL SQL commands from schema objects using <a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.get_sql_for" title="interbase.schema.BaseSchemaItem.get_sql_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sql_for()</span></code></a> method
present on all schema objects except Schema itself. DDL commands that could be generated depend on object
type and context (for example it’s not possible to generate DDL commands for system database objects), and
list of DDL commands that could be generated for particular schema object could be obtained from its
<a class="reference internal" href="reference.html#interbase.schema.BaseSchemaItem.actions" title="interbase.schema.BaseSchemaItem.actions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">actions</span></code></a> attribute.</p>
<p>Possible <cite>actions</cite> could be: create, recreate, create_or_alter, alter, drop, activate, deactivate, recompute
and declare. Some actions require/allow additional parameters.</p>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text">SQL actions</span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 15.0%" />
<col style="width: 15.0%" />
<col style="width: 5.0%" />
<col style="width: 45.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Schema class</p></th>
<th class="head"><p>Action</p></th>
<th class="head"><p>Parameter</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="reference.html#interbase.schema.Collation" title="interbase.schema.Collation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collation</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="reference.html#interbase.schema.CharacterSet" title="interbase.schema.CharacterSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">CharacterSet</span></code></a></p></td>
<td><p>alter</p></td>
<td><p>collation</p></td>
<td><p>Yes</p></td>
<td><p><a class="reference internal" href="reference.html#interbase.schema.Collation" title="interbase.schema.Collation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collation</span></code></a> instance or collation name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.DatabaseException" title="interbase.schema.DatabaseException"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseException</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>recreate</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>alter</p></td>
<td><p>message</p></td>
<td><p>Yes</p></td>
<td><p>string.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>create_or_alter</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="reference.html#interbase.schema.Domain" title="interbase.schema.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Domain</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>alter</p></td>
<td></td>
<td></td>
<td><p>One from next parameters required</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>name</p></td>
<td><p>No</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>default</p></td>
<td><p>No</p></td>
<td><p>string definition or None to drop default</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>check</p></td>
<td><p>No</p></td>
<td><p>string definition or None to drop check</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>datatype</p></td>
<td><p>No</p></td>
<td><p>string SQL datatype definition</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.Constraint" title="interbase.schema.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.Index" title="interbase.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>activate</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>deactivate</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>recompute</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="reference.html#interbase.schema.Table" title="interbase.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>recreate</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.TableColumn" title="interbase.schema.TableColumn"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableColumn</span></code></a></p></td>
<td><p>alter</p></td>
<td></td>
<td></td>
<td><p>One from next parameters required</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>name</p></td>
<td><p>No</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>datatype</p></td>
<td><p>No</p></td>
<td><p>string SQL type definition</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>position</p></td>
<td><p>No</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>expression</p></td>
<td><p>No</p></td>
<td><p>string with COMPUTED BY expression</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="reference.html#interbase.schema.View" title="interbase.schema.View"><code class="xref py py-class docutils literal notranslate"><span class="pre">View</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>recreate</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>alter</p></td>
<td><p>columns</p></td>
<td><p>No</p></td>
<td><p>string or list of strings</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>query</p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>check</p></td>
<td><p>No</p></td>
<td><p>True for WITH CHECK OPTION clause</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>create_or_alter</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.Trigger" title="interbase.schema.Trigger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trigger</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>recreate</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>create_or_alter</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>alter</p></td>
<td></td>
<td></td>
<td><p>Requires parameters for either header or body definition.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>fire_on</p></td>
<td><p>No</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>active</p></td>
<td><p>No</p></td>
<td><p>bool</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>sequence</p></td>
<td><p>No</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>declare</p></td>
<td><p>No</p></td>
<td><p>string or list of strings</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>code</p></td>
<td><p>No</p></td>
<td><p>string or list of strings</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.Procedure" title="interbase.schema.Procedure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Procedure</span></code></a></p></td>
<td><p>create</p></td>
<td><p>no_code</p></td>
<td><p>No</p></td>
<td><p>True to supress procedure body from output</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>recreate</p></td>
<td><p>no_code</p></td>
<td><p>No</p></td>
<td><p>True to supress procedure body from output</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>create_or_alter</p></td>
<td><p>no_code</p></td>
<td><p>No</p></td>
<td><p>True to supress procedure body from output</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.Role" title="interbase.schema.Role"><code class="xref py py-class docutils literal notranslate"><span class="pre">Role</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.Function" title="interbase.schema.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a></p></td>
<td><p>declare</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="reference.html#interbase.schema.DatabaseFile" title="interbase.schema.DatabaseFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseFile</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="reference.html#interbase.schema.Shadow" title="interbase.schema.Shadow"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shadow</span></code></a></p></td>
<td><p>create</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>drop</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="reference.html#interbase.schema.Privilege" title="interbase.schema.Privilege"><code class="xref py py-class docutils literal notranslate"><span class="pre">Privilege</span></code></a></p></td>
<td><p>grant</p></td>
<td><p>grantors</p></td>
<td><p>No</p></td>
<td><p>List of grantor names. Generates GRANTED BY clause if grantor is not in list.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>revoke</p></td>
<td><p>grantors</p></td>
<td><p>No</p></td>
<td><p>List of grantor names. Generates GRANTED BY clause if grantor is not in list.</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>grant_option</p></td>
<td><p>No</p></td>
<td><p>True to get REVOKE of GRANT/ADMIN OPTION only. Raises ProgrammingError if privilege
doesn’t have such option.</p></td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;EMPLOYEE&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">t</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;create&#39;</span><span class="p">)</span>
<span class="go">CREATE TABLE EMPLOYEE</span>
<span class="go">(</span>
<span class="go">  EMP_NO EMPNO NOT NULL,</span>
<span class="go">  FIRST_NAME &quot;FIRSTNAME&quot; NOT NULL,</span>
<span class="go">  LAST_NAME &quot;LASTNAME&quot; NOT NULL,</span>
<span class="go">  PHONE_EXT VARCHAR(4),</span>
<span class="go">  HIRE_DATE TIMESTAMP DEFAULT &#39;NOW&#39; NOT NULL,</span>
<span class="go">  DEPT_NO DEPTNO NOT NULL,</span>
<span class="go">  JOB_CODE JOBCODE NOT NULL,</span>
<span class="go">  JOB_GRADE JOBGRADE NOT NULL,</span>
<span class="go">  JOB_COUNTRY COUNTRYNAME NOT NULL,</span>
<span class="go">  SALARY SALARY NOT NULL,</span>
<span class="go">  FULL_NAME COMPUTED BY (last_name || &#39;, &#39; || first_name),</span>
<span class="go">  PRIMARY KEY (EMP_NO)</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">indices</span><span class="p">:</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="s1">&#39;create&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
<span class="gp">... </span>       <span class="nb">print</span> <span class="n">i</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;create&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">CREATE ASCENDING INDEX NAMEX</span>
<span class="go">   ON EMPLOYEE (LAST_NAME,FIRST_NAME)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">constraints</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ischeck</span><span class="p">()</span> <span class="ow">or</span> <span class="n">x</span><span class="o">.</span><span class="n">isfkey</span><span class="p">()]:</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">c</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;create&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">ALTER TABLE EMPLOYEE ADD FOREIGN KEY (DEPT_NO)</span>
<span class="go">  REFERENCES DEPARTMENT (DEPT_NO)</span>
<span class="go">ALTER TABLE EMPLOYEE ADD FOREIGN KEY (JOB_CODE,JOB_GRADE,JOB_COUNTRY)</span>
<span class="go">  REFERENCES JOB (JOB_CODE,JOB_GRADE,JOB_COUNTRY)</span>
<span class="go">ALTER TABLE EMPLOYEE ADD CHECK ( salary &gt;= (SELECT min_salary FROM job WHERE</span>
<span class="go">                        job.job_code = employee.job_code AND</span>
<span class="go">                        job.job_grade = employee.job_grade AND</span>
<span class="go">                        job.job_country = employee.job_country) AND</span>
<span class="go">            salary &lt;= (SELECT max_salary FROM job WHERE</span>
<span class="go">                        job.job_code = employee.job_code AND</span>
<span class="go">                        job.job_grade = employee.job_grade AND</span>
<span class="go">                        job.job_country = employee.job_country))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">get_procedure</span><span class="p">(</span><span class="s1">&#39;GET_EMP_PROJ&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;recreate&#39;</span><span class="p">,</span><span class="n">no_code</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">RECREATE PROCEDURE GET_EMP_PROJ (EMP_NO SMALLINT)</span>
<span class="go">RETURNS (PROJ_ID CHAR(5))</span>
<span class="go">AS</span>
<span class="go">BEGIN</span>
<span class="go">END</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;create_or_alter&#39;</span><span class="p">)</span>
<span class="go">CREATE OR ALTER PROCEDURE GET_EMP_PROJ (EMP_NO SMALLINT)</span>
<span class="go">RETURNS (PROJ_ID CHAR(5))</span>
<span class="go">AS</span>
<span class="go">BEGIN</span>
<span class="go">     FOR SELECT proj_id</span>
<span class="go">             FROM employee_project</span>
<span class="go">             WHERE emp_no = :emp_no</span>
<span class="go">             INTO :proj_id</span>
<span class="go">     DO</span>
<span class="go">             SUSPEND;</span>
<span class="go">END</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;alter&#39;</span><span class="p">,</span><span class="nb">input</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;In1 INTEGER&#39;</span><span class="p">,</span><span class="s1">&#39;In2 VARCHAR(5)&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;Out1 INETEGER,</span><span class="se">\n</span><span class="s1">Out2 VARCHAR(10)&#39;</span><span class="p">,</span><span class="n">declare</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;declare variable i integer = 1;&#39;</span><span class="p">],</span>
<span class="gp">... </span><span class="n">code</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/* body */&#39;</span><span class="p">,</span><span class="s1">&#39;Out1 = i&#39;</span><span class="p">,</span><span class="s2">&quot;Out2 = &#39;Value&#39;&quot;</span><span class="p">])</span>
<span class="go">ALTER PROCEDURE GET_EMP_PROJ (</span>
<span class="go">  In1 INTEGER,</span>
<span class="go">  In2 VARCHAR(5)</span>
<span class="go">)</span>
<span class="go">RETURNS (Out1 INETEGER,</span>
<span class="go">Out2 VARCHAR(10))</span>
<span class="go">AS</span>
<span class="go">  declare variable i integer = 1;</span>
<span class="go">BEGIN</span>
<span class="go">  /* body */</span>
<span class="go">  Out1 = i</span>
<span class="go">  Out2 = &#39;Value&#39;</span>
<span class="go">END</span>
</pre></div>
</div>
</section>
</section>
<section id="working-with-user-privileges">
<h2>Working with user privileges<a class="headerlink" href="#working-with-user-privileges" title="Permalink to this heading">¶</a></h2>
<p>User or database object privileges are part of database metadata accessible through Interbase
<a class="reference internal" href="reference.html#interbase.schema.Schema" title="interbase.schema.Schema"><code class="xref py py-class docutils literal notranslate"><span class="pre">Schema</span></code></a> support.
Each discrete privilege is represented by <a class="reference internal" href="reference.html#interbase.schema.Privilege" title="interbase.schema.Privilege"><code class="xref py py-class docutils literal notranslate"><span class="pre">Privilege</span></code></a> instance. You can access either
<a class="reference internal" href="reference.html#interbase.schema.Schema.privileges" title="interbase.schema.Schema.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">all</span></code></a> privileges, or privileges granted for specific
<a class="reference internal" href="reference.html#interbase.schema.Table.privileges" title="interbase.schema.Table.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.TableColumn.privileges" title="interbase.schema.TableColumn.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span> <span class="pre">column</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.View.privileges" title="interbase.schema.View.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">view</span></code></a>, <a class="reference internal" href="reference.html#interbase.schema.ViewColumn.privileges" title="interbase.schema.ViewColumn.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">view</span> <span class="pre">column</span></code></a>,
<a class="reference internal" href="reference.html#interbase.schema.Procedure.privileges" title="interbase.schema.Procedure.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">procedure</span></code></a> or <a class="reference internal" href="reference.html#interbase.schema.Role.privileges" title="interbase.schema.Role.privileges"><code class="xref py py-attr docutils literal notranslate"><span class="pre">role</span></code></a>. It’s also
possible to get all privileges <a class="reference internal" href="reference.html#interbase.schema.Schema.get_privileges_of" title="interbase.schema.Schema.get_privileges_of"><code class="xref py py-meth docutils literal notranslate"><span class="pre">granted</span> <span class="pre">to</span></code></a> specific user, role,
procedure, trigger or view.</p>
<p><a class="reference internal" href="reference.html#interbase.schema.Privilege" title="interbase.schema.Privilege"><code class="xref py py-class docutils literal notranslate"><span class="pre">Privilege</span></code></a> class supports <a class="reference internal" href="reference.html#interbase.schema.Privilege.get_sql_for" title="interbase.schema.Privilege.get_sql_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sql_for()</span></code></a> method to generate
GRANT and REVOKE SQL statements for given privilege. If you want to generate grant/revoke statements for
set of privileges (for example all privileges granted on specific object or grated to specific user), it’s
more convenient to use function <a class="reference internal" href="reference.html#interbase.schema.get_grants" title="interbase.schema.get_grants"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_grants()</span></code></a> that returns list of minimal set of SQL
commands required to task.</p>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">interbase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">interbase</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dsn</span><span class="o">=</span><span class="s1">&#39;employee&#39;</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">&#39;sysdba&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;masterkey&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">get_table</span><span class="p">(</span><span class="s1">&#39;EMPLOYEE&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">privileges</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">get_sql_for</span><span class="p">(</span><span class="s1">&#39;grant&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">GRANT SELECT ON EMPLOYEE TO SYSDBA WITH GRANT OPTION</span>
<span class="go">GRANT INSERT ON EMPLOYEE TO SYSDBA WITH GRANT OPTION</span>
<span class="go">GRANT UPDATE ON EMPLOYEE TO SYSDBA WITH GRANT OPTION</span>
<span class="go">GRANT DELETE ON EMPLOYEE TO SYSDBA WITH GRANT OPTION</span>
<span class="go">GRANT REFERENCES ON EMPLOYEE TO SYSDBA WITH GRANT OPTION</span>
<span class="go">GRANT SELECT ON EMPLOYEE TO PUBLIC WITH GRANT OPTION</span>
<span class="go">GRANT INSERT ON EMPLOYEE TO PUBLIC WITH GRANT OPTION</span>
<span class="go">GRANT UPDATE ON EMPLOYEE TO PUBLIC WITH GRANT OPTION</span>
<span class="go">GRANT DELETE ON EMPLOYEE TO PUBLIC WITH GRANT OPTION</span>
<span class="go">GRANT REFERENCES ON EMPLOYEE TO PUBLIC WITH GRANT OPTION</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">interbase</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">get_grants</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">privileges</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">p</span>
<span class="gp">...</span>
<span class="go">GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON EMPLOYEE TO PUBLIC WITH GRANT OPTION</span>
<span class="go">GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE ON EMPLOYEE TO SYSDBA WITH GRANT OPTION</span>
</pre></div>
</div>
<p>Normally generated GRANT/REVOKE statements don’t contain grantor’s name, because GRANTED BY clause
is supported only since InterBase 2.5. If you want to get GRANT/REVOKE statements including this clause,
use <cite>grantors</cite> parameter for <cite>get_sql_for</cite> and <cite>get_grants</cite>. This parameter is a list of grantor names,
and GRANTED BY clause is generated only for privileges not granted by user from this list. It’s useful
to suppress GRANTED BY clause for SYSDBA or database owner.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Usage Guide</a><ul>
<li><a class="reference internal" href="#driver-structure">Driver structure</a></li>
<li><a class="reference internal" href="#databases">Databases</a><ul>
<li><a class="reference internal" href="#using-connect">Using <cite>connect</cite></a></li>
<li><a class="reference internal" href="#using-create-database">Using <cite>create_database</cite></a></li>
<li><a class="reference internal" href="#deleting-databases">Deleting databases</a></li>
<li><a class="reference internal" href="#connection-object">Connection object</a></li>
<li><a class="reference internal" href="#getting-information-about-interbase-version">Getting information about InterBase version</a></li>
<li><a class="reference internal" href="#database-on-disk-structure">Database On-Disk Structure</a></li>
<li><a class="reference internal" href="#getting-information-about-database">Getting information about database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#executing-sql-statements">Executing SQL Statements</a><ul>
<li><a class="reference internal" href="#cursor-object">Cursor object</a></li>
<li><a class="reference internal" href="#sql-execution-basics">SQL Execution Basics</a></li>
<li><a class="reference internal" href="#parameterized-statements">Parameterized statements</a></li>
<li><a class="reference internal" href="#fetching-data-from-server">Fetching data from server</a></li>
<li><a class="reference internal" href="#prepared-statements">Prepared Statements</a></li>
<li><a class="reference internal" href="#named-cursors">Named Cursors</a></li>
<li><a class="reference internal" href="#working-with-stored-procedures">Working with stored procedures</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-handling-and-conversions">Data handling and conversions</a><ul>
<li><a class="reference internal" href="#implicit-conversion-of-input-parameters-from-strings">Implicit Conversion of Input Parameters from Strings</a></li>
<li><a class="reference internal" href="#automatic-conversion-from-to-unicode">Automatic conversion from/to unicode</a></li>
<li><a class="reference internal" href="#working-with-blobs">Working with BLOBs</a></li>
<li><a class="reference internal" href="#interbase-array-type">InterBase ARRAY type</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transanction-management">Transanction management</a><ul>
<li><a class="reference internal" href="#basics">Basics</a></li>
<li><a class="reference internal" href="#auto-commit">Auto-commit</a></li>
<li><a class="reference internal" href="#transaction-parameters">Transaction parameters</a></li>
<li><a class="reference internal" href="#getting-information-about-transaction">Getting information about transaction</a></li>
<li><a class="reference internal" href="#retaining-transactions">Retaining transactions</a></li>
<li><a class="reference internal" href="#savepoints">Savepoints</a></li>
<li><a class="reference internal" href="#using-multiple-transactions-with-the-same-connection">Using multiple transactions with the same connection</a></li>
<li><a class="reference internal" href="#distributed-transactions">Distributed Transactions</a></li>
<li><a class="reference internal" href="#transaction-context-manager">Transaction Context Manager</a></li>
</ul>
</li>
<li><a class="reference internal" href="#database-events">Database Events</a><ul>
<li><a class="reference internal" href="#what-they-are">What they are</a></li>
<li><a class="reference internal" href="#why-use-them">Why use them</a></li>
<li><a class="reference internal" href="#how-events-are-exposed">How events are exposed</a></li>
<li><a class="reference internal" href="#api-for-python-developers">API for Python developers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-services">Working with Services</a><ul>
<li><a class="reference internal" href="#services-api-connections">Services API Connections</a></li>
<li><a class="reference internal" href="#server-configuration-and-state">Server Configuration and State</a></li>
<li><a class="reference internal" href="#database-options">Database options</a></li>
<li><a class="reference internal" href="#database-maintenance">Database maintenance</a></li>
<li><a class="reference internal" href="#user-maintenance">User maintenance</a></li>
<li><a class="reference internal" href="#text-ouput-from-services">Text ouput from Services</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-database-schema">Working with database schema</a><ul>
<li><a class="reference internal" href="#available-information">Available information</a></li>
<li><a class="reference internal" href="#metadata-objects">Metadata objects</a></li>
<li><a class="reference internal" href="#visitor-pattern-support">Visitor Pattern support</a></li>
<li><a class="reference internal" href="#object-dependencies">Object dependencies</a></li>
<li><a class="reference internal" href="#sql-operations">SQL operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-user-privileges">Working with user privileges</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="getting-started.html"
                          title="previous chapter">Getting Started with Interbase</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="python-db-api-compliance.html"
                          title="next chapter">Compliance to Python Database API 2.0</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/usage-guide.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="python-db-api-compliance.html" title="Compliance to Python Database API 2.0"
             >next</a> |</li>
        <li class="right" >
          <a href="getting-started.html" title="Getting Started with Interbase"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Interbase 1.4.9 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Usage Guide</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright Embarcadero Technologies, Inc..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    </div>
  </body>
</html>